_type: yaraGroupRule
seedId: 4979136d-4325-47b5-bf72-4c78069502d4
name: upt_intel_cross_platform_yara_rules
description: Contextual detection rules
rules: "rule Uptycs_Coinminer\n{\n\tmeta:\n\t\tmalware_name = \"Coinminer\"\n\t\tdescription = \"Coin miner is an application that uses the infected device's physical resources to mine digital currency.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Coinminer0 = \"mining server\" ascii wide\n\t\t$Coinminer1 = \"stratum+tcp://\" ascii wide\n\t\t$Coinminer2 = \"stratum+udp://\" ascii wide\n\t\t$Coinminer3 = \"stratum+ssl://\" ascii wide\n\n\tcondition:\n\t\t2 of ($Coinminer*)\n}\n\n\nrule Uptycs_Xmrig\n{\n\tmeta:\n\t\tmalware_name = \"Xmrig\"\n\t\tdescription = \"Xmrig is an open sourced Monero CPU Miner used to mine Monero cryptocurrency.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Xmrig0 = \"xmrig [OPTIONS]\" ascii wide\n\t\t$Xmrig1 = \"XMRIG_\" ascii wide\n\t\t$Coinminer0 = \"mining server\" ascii wide\n\t\t$Coinminer1 = \"stratum+tcp://\" ascii wide\n\t\t$Coinminer2 = \"stratum+udp://\" ascii wide\n\t\t$Coinminer3 = \"stratum+ssl://\" ascii wide\n\n\tcondition:\n\t\t1 of ($Xmrig*) and 2 of ($Coinminer*)\n}\n\n\nrule Uptycs_Tsunami\n{\n\tmeta:\n\t\tmalware_name = \"Tsunami\"\n\t\tdescription = \"Tsunami is a cross platform based distributed denial-of-service (DDoS) flooder that is also capable of downloading files and executing shell commands in an infected system.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Tsunami0 = \"<ip> <port> <path> <host> <secs>\" ascii wide\n\t\t$Tsunami1 = \"<target> <port> <secs>\" ascii wide\n\t\t$Tsunami2 = \"TSUNAMI <target> <secs>\" ascii wide\n\t\t$Tsunami3 = \"Tsunami heading for %s.\" ascii wide\n\n\tcondition:\n\t\t3 of ($Tsunami*)\n}\n\n\nrule Uptycs_MATA\n{\n\tmeta:\n\t\tmalware_name = \"MATA\"\n\t\tdescription = \"Mata is a multi-platform targeted malware framework used to infiltrate corporate entities around the world.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$MATA0 = \"c_2910.cls\" ascii wide\n\t\t$MATA1 = \"k_3872.cls\" ascii wide\n\t\t$MATA2 = \"SCAN\t%s\t%d.%d.%d.%d\t%d\" ascii wide\n\t\t$MATA3 = \"Software\\\\mthjk\" ascii wide\n\t\t$MATA4 = \"Software\\\\Microsoft\\\\HlqNet\" ascii wide\n\t\t$MATA5 = \"Software\\\\Microsoft\\\\KxtNet\" ascii wide\n\t\t$MATA6 = \"plugin_file\" ascii wide\n\t\t$MATA7 = \"plugin_reverse_p2p\" ascii wide\n\t\t$MATA8 = \"plugin_socks\" ascii wide\n\t\t$MATA9 = \"Proxy-agent: matt-dot-net\" ascii wide\n\t\t$MATA10 = \"MATA_Plug_\" ascii wide\n\t\t$MATA11 = \"Keep-Alive: 3000\" ascii wide\n\n\tcondition:\n\t\t3 of ($MATA*)\n}\n\n\nrule Uptycs_Masscan\n{\n\tmeta:\n\t\tmalware_name = \"Masscan\"\n\t\tdescription = \"Masscan is a port scanner that uses its own ad hoc TCP/IP allowing arbitrary port and address ranges using asynchronous transmission.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Masscan0 = \"EHLO masscan\" ascii wide\n\t\t$Masscan1 = \"User-Agent: masscan\" ascii wide\n\t\t$Masscan2 = \"nmap(%s): unsupported\" ascii wide\n\n\tcondition:\n\t\t2 of ($Masscan*)\n}\n\n\nrule Uptycs_IPStorm\n{\n\tmeta:\n\t\tmalware_name = \"IPStorm\"\n\t\tdescription = \"IPStorm is a botnet that abuses a legitimate Peer-to-peer (p2p) network called InterPlanetary File System (IPFS) as a means to obscure malicious traffic.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$IPStorm0 = \"storm/scan_tools/\" ascii wide\n\t\t$IPStorm1 = \"storm/p2p/\" ascii wide\n\t\t$IPStorm2 = \"storm/backshell\" ascii wide\n\t\t$IPStorm3 = \"bhendo/go-powershell/backend\" ascii wide\n\t\t$IPStorm4 = \"n3R1PYfY\" ascii wide\n\t\t$IPStorm5 = \"Persist not implemented on platform %s\" ascii wide\n\t\t$IPStorm6 = \"storm/avbypass.\" ascii wide\n\n\tcondition:\n\t\t3 of ($IPStorm*)\n}\n\n\nrule Uptycs_ElectroRAT\n{\n\tmeta:\n\t\tmalware_name = \"ElectroRAT\"\n\t\tdescription = \"ElectroRAT is written in Golang and compiled to target multiple operating systems to collect private keys to access victimsâ€™ wallets.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$ElectroRAT0 = \"registerUser.go\" ascii wide\n\t\t$ElectroRAT1 = \"osinfo.go\" ascii wide\n\t\t$ElectroRAT2 = \"machineid.go\" ascii wide\n\t\t$ElectroRAT3 = \"downloadFile.go\" ascii wide\n\t\t$ElectroRAT4 = \"hidefile_windows.go\" ascii wide\n\t\t$ElectroRAT5 = \"systemcl.go\" ascii wide\n\t\t$ElectroRAT6 = \"screenshot.go\" ascii wide\n\n\tcondition:\n\t\t3 of ($ElectroRAT*)\n}\n\n\nrule Uptycs_Hashcat\n{\n\tmeta:\n\t\tmalware_name = \"Hashcat\"\n\t\tdescription = \"Hashcat is a password recovery tool used to crack passwords using highly optimized hashing algorithms.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Hashcat0 = \"hashcat.\" ascii wide\n\t\t$Hashcat1 = \"salts...\" ascii wide\n\t\t$Hashcat2 = \"hashes->\" ascii wide\n\t\t$Hashcat3 = \"- [ Brain Client Features ] -\" ascii wide\n\t\t$Hashcat4 = \"Hashes: %I64u/%I64u (%0.2f%%)\" ascii wide\n\t\t$Hashcat5 = \" Usage: hasssshcat [options]... hash|hashfile|hccapxfile [dictionary|mask|directory]...\" ascii wide\n\n\tcondition:\n\t\t5 of ($Hashcat*)\n}\n\n\nrule Uptycs_XAgent\n{\n\tmeta:\n\t\tmalware_name = \"XAgent\"\n\t\tdescription = \"XAgent is a spyware designed to collect and transmit hacked files from machines running Windows, Linux, iOS, or Android, to servers operated by hackers.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$XAgent0 = \":size:cmdId:\" ascii wide\n\t\t$XAgent1 = \"Your command not writed to pipe\" ascii wide\n\t\t$XAgent2 = \"TABLE FIND FILES</font></\" ascii wide\n\t\t$XAgent3 = \"TABLE READ FILES</font></\" ascii wide\n\t\t$XAgent4 = \"WRITE FILE IS NOT SUCCESS</\" ascii wide\n\t\t$XAgent5 = \"WRITE FILE IS SUCCESS</\" ascii wide\n\t\t$XAgent6 = \"TABLE DELETE FILES</font></\" ascii wide\n\t\t$XAgent7 = \"TABLE EXECUTE FILES</font></\" ascii wide\n\t\t$XAgent8 = \"My_BD\" ascii wide\n\t\t$XAgent9 = \"RemoteShell\" ascii wide\n\t\t$XAgent10 = \"-[Password\" ascii wide\n\t\t$XAgent11 = \"='keylog_\" ascii wide\n\t\t$XAgent12 = \"/Users/kazak/Desktop/Project/XAgentOSX/XAgentOSX/Source/\" ascii wide\n\t\t$XAgent13 = \"-[Keylogger\" ascii wide\n\t\t$XAgent14 = \"ftpURLForPort:\" ascii wide\n\t\t$XAgent15 = \"uploadFile:urlServer:userName:password:\" ascii wide\n\t\t$XAgent16 = \"url: %@ user: %@ password: %@\" ascii wide\n\t\t$XAgent17 = \"WantedBy=multi-user.target\" ascii wide\n\t\t$XAgent18 = \"Command will have end with\" ascii wide\n\t\t$XAgent19 = \"success execute command or long for waiting executing your command\" ascii wide\n\t\t$XAgent20 = \"RemoteShell.cpp\" ascii wide\n\t\t$XAgent21 = \"CryptoContainer.cpp\" ascii wide\n\t\t$XAgent22 = \"_ZN15installrootvars\" ascii wide\n\t\t$XAgent23 = \"_ZN15remoteshellvars\" ascii wide\n\t\t$XAgent24 = \"AgentKernel.cpp\" ascii wide\n\t\t$XAgent25 = \".?AVAgentModuleRemoteKeyLogger@@\" ascii wide\n\t\t$XAgent26 = \"# EXC: HttpSender - Cannot create Get Channel!\" ascii wide\n\t\t$XAgent27 = \"i`m wait\" ascii wide\n\t\t$XAgent28 = \"is you live?\" ascii wide\n\t\t$XAgent29 = \"\\\\PROJECT\\\\XAPS_\" ascii wide\n\t\t$XAgent30 = \">process is exist</\" ascii wide\n\t\t$XAgent31 = \">process isn't exist</\" ascii wide\n\t\t$XAgent32 = \">process isn't exist</\" ascii wide\n\t\t$XAgent33 = \"XAPS_OBJECTIVE.dll\" ascii wide \n\n\tcondition:\n\t\t6 of ($XAgent*)\n}\n\n\nrule Uptycs_Pupy\n{\n\tmeta:\n\t\tmalware_name = \"Pupy\"\n\t\tdescription = \"Pupy is a multi-platform Remote Access trojan (RAT) utilized by advanced persistent threat (APT) groups.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Pupy0 = \"dumping lsa secrets\" ascii wide\n\t\t$Pupy1 = \"dumping cached domain passwords\" ascii wide\n\t\t$Pupy2 = \"the keylogger is already started\" ascii wide\n\t\t$Pupy3 = \"pupyutils.\" ascii wide\n\t\t$Pupy4 = \"pupwinutils.\" ascii wide\n\t\t$Pupy5 = \"-PUPY_CONFIG_COMES_HERE-\" ascii wide\n\n\tcondition:\n\t\t3 of ($Pupy*)\n}\n\n\nrule Uptycs_AppleJeus\n{\n\tmeta:\n\t\tmalware_name = \"AppleJeus\"\n\t\tdescription = \"AppleJeus is a malware designed to operate and appear as legitimate crypto trading software, targeting victims who seek to trade cryptocurrencies.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$AppleJeus0 = \"jGzAcN6k4VsTRn9\" ascii wide\n\t\t$AppleJeus1 = \"12GWAPCT1F0I1S14\" ascii wide\n\t\t$AppleJeus2 = \"--jeus--\" ascii wide\n\t\t$AppleJeus3 = \"Moz&Wie;#t/6T!2y\" ascii wide\n\t\t$AppleJeus4 = \"W29ab@ad%Df324V$Yd\" ascii wide\n\t\t$AppleJeus5 = \"X,%`PMk--Jj8s+6=\" ascii wide\n\t\t$AppleJeus6 = \"/tmp/updater\" ascii wide\n\t\t$AppleJeus7 = \"Moz&Wie;#t/6T!2yW29ab@ad%Df324V$Yd\" ascii wide\n\n\tcondition:\n\t\t2 of ($AppleJeus*)\n}\n\n\nrule Uptycs_Careto\n{\n\tmeta:\n\t\tmalware_name = \"Careto\"\n\t\tdescription = \"Careto is a toolset used by the attackers to intercept communication channels and collects the most vital information from the infected system.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Careto0 = \"no program to execute\" ascii wide\n\t\t$Careto1 = \"setsockopt() REUSEADDR: %s\" ascii wide\n\t\t$Careto2 = \"connecting to %s [%s] on port %u\" ascii wide\n\t\t$Careto3 = \"connecting to %s (%s) [%s] on port %u\" ascii wide\n\t\t$Careto4 = \"connect to %s:%u from %s:%u (%s)\" ascii wide\n\t\t$Careto5 = \"Careto\" ascii wide\n\t\t$Careto6 = \"/URL_AUX\" ascii wide\n\t\t$Careto7 = \"/CaretoPruebas\" ascii wide\n\n\tcondition:\n\t\t3 of ($Careto*)\n}\n\n\nrule Uptycs_GravityRAT\n{\n\tmeta:\n\t\tmalware_name = \"GravityRAT\"\n\t\tdescription = \"GravityRAT is Remote Access Trojan (RAT) known to target India and steal data from the infected devices.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$GravityRAT0 = \"lolomycin\" ascii wide\n\t\t$GravityRAT1 = \"/Gvty@/ip.php\" ascii wide\n\t\t$GravityRAT2 = \"/G3/ServerSide/G3.php\" ascii wide\n\t\t$GravityRAT3 = \"$K&n.txt\" ascii wide\n\t\t$GravityRAT4 = \"Value=2&FingerPrint=\"  ascii wide\n\t\t$GravityRAT5 = \"DRIVEUPLOADCOMPLETED => TOTALFILES={0}, FILESUPLOADED=\"  ascii wide\n\t\t$GravityRAT6 = \"Error => start_upload_files()\"  ascii wide\n\n\n\tcondition:\n\t\t2 of ($GravityRAT*)\n}\n\n\nrule Uptycs_HabitsRAT\n{\n\tmeta:\n\t\tmalware_name = \"HabitsRAT\"\n\t\tdescription = \"HabitsRAT is a Golang based backdoor that allows the malware operator to execute arbitrary code on the infected machine.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$HabitsRAT0 = \"commandplatform_\" ascii wide\n\t\t$HabitsRAT1 = \"keyplatform_\" ascii wide\n\t\t$HabitsRAT2 = \"persistencehandler_\" ascii wide\n\t\t$HabitsRAT3 = \"validateTarget\" ascii wide\n\t\t$HabitsRAT4 = \"targetpc\" ascii wide\n\n\tcondition:\n\t\t4 of ($HabitsRAT*)\n}\n\n\nrule Uptycs_Lazagne_V1\n{\n\tmeta:\n\t\tmalware_name = \"Lazagne\"\n\t\tdescription = \"LaZagne is a post-exploitation tool used to recover stored passwords on a system\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Lazagne0 = \"laZagne\" ascii wide\n\t\t$Lazagne1 = \"config.dico\" ascii wide\n\t\t$Lazagne2 = \"softwares.mozilla\" ascii wide\n\t\t$Lazagne3 = \"Crypto.Hash\" ascii wide\n\n\tcondition:\n\t\tall of ($Lazagne*)\n}\n\n\nrule Uptycs_Coinminer_V1\n{\n\tmeta:\n\t\tmalware_name = \"Coinminer\"\n\t\tdescription = \"Coin miner is an application that uses the infected device's physical resources to mine digital currency.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Coinminer0 = \"nicehash\" ascii wide\n\t\t$Coinminer1 = \"hashrate\" ascii wide\n\t\t$Coinminer2 = \"getwork://\" ascii wide\n\t\t$Coinminer3 = \"stratum+tcp://\" ascii wide\n\t\t$Coinminer4 = \"stratum+udp://\" ascii wide\n\t\t$Coinminer5 = \"stratum+ssl://\" ascii wide\n\n\tcondition:\n\t\t4 of ($Coinminer*)\n}\n\n\nrule Uptycs_YTDownloader\n{\n\tmeta:\n\t\tmalware_name = \"YTDownloader\"\n\t\tdescription = \"YTDownloader is an adware program that displays pop-up ads and unwanted advertisements not originating from the sites you are browsing\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$YTDL0 = \"ytddownloader.com\" ascii wide\n\t\t$YTDL1 = \"greentreeapplications\" ascii wide\n\t\t$YTDL2 = \"GreenTree Applications\" ascii wide\n\t\t$YTDL3 = \"premium.html?\" ascii wide\n\n\tcondition:\n\t\t3 of ($YTDL*)\n}\n\n\nrule Uptycs_Smaug\n{\n\tmeta:\n\t\tmalware_name = \"Smaug\"\n\t\tdescription = \"Smaug is a completely customizable and multiplatform Golang based Ransomware as a Service\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Smaug0 = \"runtime._panic\" ascii wide\n\t\t$Smaug1 = \"NewCBCEncrypter\" ascii wide\n\t\t$Smaug2 = \"Lock/internal/pkg/encryption.EncryptFile\" ascii wide\n\t\t$Smaug3 = \"src/Lock/cmd/payload/main.go\" ascii wide\n\t\t$Smaug4 = \"main.main.func1\" ascii wide\n\n\n\tcondition:\n\t\tall of ($Smaug*)\n}"
custom: false
