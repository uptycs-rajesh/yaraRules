_type: yaraGroupRule
seedId: 0ff9ef80-46a5-4abe-84ed-91ce513bd2d7
name: upt_intel_macos_yara_rules
description: contextual detections
rules: "rule Uptycs_Calisto\n{\n\tmeta:\n\t\tmalware_name = \"Calisto\"\n\t\tdescription = \"Calisto is a malware that fraudulently disguises itself as a security softwares, performing as backdoor and information stealer.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Calisto0 = \"---SUCCESS---\" ascii wide\n\t\t$Calisto1 = \"~/.calisto/\" ascii wide\n\t\t$Calisto2 = \"sudo systemsetup -setcomputersleep Never &&  sudo cp -R /Volumes/Mac\" ascii wide\n\t\t$Calisto3 = \"action_awaits\" ascii wide\n\n\tcondition:\n\t\tall of ($Calisto*)\n}\n\n\nrule Uptycs_AoboKeylogger\n{\n\tmeta:\n\t\tmalware_name = \"AoboKeylogger\"\n\t\tdescription = \"Aobo Keylogger is an easy-to-install application that records every keystroke entered on a computer.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$AoboKeylogger0 = \"Logs uploaded successfully!\" ascii wide\n\t\t$AoboKeylogger1 = \"FTP connection failed!\" ascii wide\n\t\t$AoboKeylogger2 = \"Connecting...\" ascii wide\n\t\t$AoboKeylogger3 = \"FTP connected! Start uploading...\" ascii wide\n\t\t$AoboKeylogger4 = \"Aobo Keylogger\" ascii wide\n\t\t$AoboKeylogger5 = \"/aobo.log\" ascii wide\n\t\t$AoboKeylogger6 = \"logs available to view</b></font></body></html>\" ascii wide\n\t\t$AoboKeylogger7 = \"/.A_o_b_o_p_r_o/\" ascii wide\n\n\tcondition:\n\t\t6 of ($AoboKeylogger*)\n}\n\n\nrule Uptycs_TheifQuest\n{\n\tmeta:\n\t\tmalware_name = \"TheifQuest\"\n\t\tdescription = \"TheifQuest is a malware that targets macOS devices, encrypts files, and installs keyloggers in affected systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$TheifQuest0 = \"/toidievitceffe/libtpyrc\" ascii wide\n\t\t$TheifQuest1 = \"q?s=%s&h=%s\" ascii wide\n\t\t$TheifQuest2 = \"This application has to be run by root\" ascii wide\n\t\t$TheifQuest3 = \"Aborting\" ascii wide\n\t\t$TheifQuest4 = \"_generate_xkey\" ascii wide\n\t\t$TheifQuest5 = \"Cannot create thread!\" ascii wide\n\t\t$TheifQuest6 = \"PPK76!dfa82\" ascii wide\n\t\t$TheifQuest7 = \"%)+/5;=CGIOSYaegkmq\" ascii wide\n\t\t$TheifQuest8 = \"_get_process_list\" ascii wide\n\t\t$TheifQuest9 = \"_eip_encrypt\" ascii wide\n\t\t$TheifQuest10 = \"_eip_decrypt\" ascii wide\n\n\tcondition:\n\t\t5 of ($TheifQuest*)\n}\n\n\nrule Uptycs_SniperSpy\n{\n\tmeta:\n\t\tmalware_name = \"SniperSpy\"\n\t\tdescription = \"SniperSpy is computer monitoring software to monitor children or employees' online activities.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$SniperSpy0 = \"KeyLogs\" ascii wide\n\t\t$SniperSpy1 = \"ChatLogs\" ascii wide\n\t\t$SniperSpy2 = \"ScrLogs\" ascii wide\n\t\t$SniperSpy3 = \"macapi/login.php?username=%@&password=%@\" ascii wide\n\n\tcondition:\n\t\tall of ($SniperSpy*)\n}\n\n\nrule Uptycs_MaMi\n{\n\tmeta:\n\t\tmalware_name = \"MaMi\"\n\t\tdescription = \"MaMi is a malware that attempts to hijack a victim’s DNS requests by injecting its own DNS servers into an infected system.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$MaMi0 = \"anotherInstanceIsRunnging\" ascii wide\n\t\t$MaMi1 = \"old_secondary_dns\" ascii wide\n\t\t$MaMi2 = \"checkedDNSBlackList\" ascii wide\n\t\t$MaMi3 = \"hosts_active\" ascii wide\n\t\t$MaMi4 = \"/usr/bin/killall\" ascii wide\n\n\tcondition:\n\t\tall of ($MaMi*)\n}\n\n\nrule Uptycs_KeRanger\n{\n\tmeta:\n\t\tmalware_name = \"KeRanger\"\n\t\tdescription = \"KeRanger is a fully functional ransomware that primarily affects Mac OS X based operating systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$KeRanger0 = \"%s/Library/kernel_service\" ascii wide\n\t\t$KeRanger1 = \"%s/Library/.kernel_pid\" ascii wide\n\t\t$KeRanger2 = \"%s/Library/.kernel_time\" ascii wide\n\t\t$KeRanger3 = \"%s/Library/.kernel_complete\" ascii wide\n\t\t$KeRanger4 = \"%s//Resources/General.rtf\" ascii wide\n\t\t$KeRanger5 = \"README_FOR_DECRYPT.txt\" ascii wide\n\t\t$KeRanger6 = \".encrypted\" ascii wide\n\t\t$KeRanger7 = \"_create_tcp_socket\" ascii wide\n\t\t$KeRanger8 = \"_execute_cmd\" ascii wide\n\t\t$KeRanger9 = \"encrypt_timemachine\" ascii wide\n\n\tcondition:\n\t\t3 of ($KeRanger*)\n}\n\n\nrule Uptycs_IceFog\n{\n\tmeta:\n\t\tmalware_name = \"IceFog\"\n\t\tdescription = \"Icefog is an advanced persistent threat that has been active since at least 2011, targeting mostly Japan and South Korea.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$IceFog0 = \"keyLogger\" ascii wide\n\t\t$IceFog1 = \"%@/upload.aspx?filepath=ok&filename=%@.jpg\" ascii wide\n\t\t$IceFog2 = \"%@/upload.aspx?filepath=order&filename=%@.jpg\" ascii wide\n\t\t$IceFog3 = \"%@/upload.aspx?filepath=%@&filename=%@.jpg\" ascii wide\n\n\tcondition:\n\t\t3 of ($IceFog*)\n}\n\n\nrule Uptycs_Dok\n{\n\tmeta:\n\t\tmalware_name = \"Dok\"\n\t\tdescription = \"Dok is a malware that can eavesdrop on secure HTTPS trafficby redirecting a victim's traffic through a malicious proxy server.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Dok0 = \"RunAtLoad\" ascii wide\n\t\t$Dok1 = \"killall Safari\" ascii wide\n\t\t$Dok2 = \"killall firefox\" ascii wide\n\t\t$Dok3 = \"killall \\\"Google Chrome\\\"\" ascii wide\n\t\t$Dok4 = \"do shell script\" ascii wide\n\t\t$Dok5 = \"security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain %@\" ascii wide\n\t\t$Dok6 =  \"%@  ALL=(ALL) NOPASSWD: ALL\" ascii wide\n\n\n\n\tcondition:\n\t\tall of ($Dok*)\n}\n\n\nrule Uptycs_CallMe\n{\n\tmeta:\n\t\tmalware_name = \"CallMe\"\n\t\tdescription = \"CallMe is a malware based on a publicly available tool called Tiny shell.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$CallMe0 = \"!@#$00!@#$\" ascii wide\n\t\t$CallMe1 = \"!@#$11!@#$921\" ascii wide\n\t\t$CallMe2 = \"_Return_Shell\" ascii wide\n\t\t$CallMe3 = \"_tshd_runshell\" ascii wide\n\t\t$CallMe4 = \"_aes_decrypt\" ascii wide\n\t\t$CallMe5 = \"_aes_encrypt\" ascii wide\n\t\t$CallMe6 = \"_aes_set_key\" ascii wide\n\n\tcondition:\n\t\t6 of ($CallMe*)\n}\n\n\nrule Uptycs_Shlayer_Tail\n{\n\tmeta:\n\t\tmalware_name = \"Shlayer\"\n\t\tdescription = \"Shlayer is a malvertising-focused trojan mainly targeting macOS machines.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Shlayer0 = \"#!/bin/\" ascii wide\n\t\t$Shlayer1 = \"mktemp\" ascii wide\n\t\t$Shlayer2 = \"tail\" ascii wide\n\t\t$Shlayer3 = \"funzip\" ascii wide\n\t\t$Shlayer4 = \"chmod\" ascii wide\n\t\t$Shlayer5 = \"nohup\" ascii wide\n\t\t$Shlayer6 = \"/dev/nul\" ascii wide\n\t\t$Shlayer7 = \"2>&1\" ascii wide\n\t\t$Shlayer8 = \"PK\" ascii wide\n\t\t$Shlayer9 = \"killall\" ascii wide\n\n\tcondition:\n\t\t9 of ($Shlayer*)\n}\n\n\nrule Uptycs_Shlayer_Head\n{\n\tmeta:\n\t\tmalware_name = \"Shlayer\"\n\t\tdescription = \"Shlayer is a malvertising-focused trojan mainly targeting macOS machines.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Shlayer0 = \"#!/bin/\" ascii wide\n\t\t$Shlayer1 = \"mktemp\" ascii wide\n\t\t$Shlayer2 = \"head\" ascii wide\n\t\t$Shlayer5 = \"decrypted\" ascii wide\n\t\t$Shlayer6 = \"-256-cbc\" ascii wide\n\t\t$Shlayer7 = \"nohup\" ascii wide\n\t\t$Shlayer8 = \"/dev/nul\" ascii wide\n\t\t$Shlayer9 = \"2>&1\" ascii wide\n\t\t$Shlayer10 = \"killall\" ascii wide\n\n\tcondition:\n\t\tall of ($Shlayer*)\n}\n\n\nrule Uptycs_BitcoinMiner\n{\n\tmeta:\n\t\tmalware_name = \"Coinminer\"\n\t\tdescription = \"Coin miner is an application that uses the computing power to mine digital currency.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$BitcoinMiner0 = \"SendCoins\" ascii wide\n\t\t$BitcoinMiner1 = \"CoinControl\" ascii wide\n\t\t$BitcoinMiner2 = \"bitcoin-\" ascii wide\n\t\t$BitcoinMiner3 = \"miner\" ascii wide\n\n\tcondition:\n\t\tall of ($BitcoinMiner*)\n}\n\n\nrule Uptycs_Bundlore\n{\n\tmeta:\n\t\tmalware_name = \"Bundlore\"\n\t\tdescription = \"Bundlore is an installer which bundles legitimate applications with offers for additional unwanted third party applications.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Bundlore0 = \"Install additional free software\" ascii wide\n\t\t$Bundlore1 = \"/getTorrentClickID?id=\" ascii wide\n\t\t$Bundlore2 = \"curl -fsL\" ascii wide\n\t\t$Bundlore3 = \"&clickId=\" ascii wide\n\t\t$Bundlore4 = \"-shh\" ascii wide\n\t\t$Bundlore5 = \"url=\" ascii wide\n\t\t$Bundlore6 = \"- Downloader\" ascii wide\n\t\t$Bundlore7 = \"thread constructor failed\" ascii wide\n\n\tcondition:\n\t\tall of ($Bundlore*)\n}\n\n\nrule Uptycs_Installcore_AssetsChanger\n{\n\tmeta:\n\t\tmalware_name = \"Installcore\"\n\t\tdescription = \"Install Core is an installer which bundles legitimate applications with offers for additional third party applications that may be unwanted by the user.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Installcore0 = \"AssetsChanger <options> command [arg]\" ascii wide\n\t\t$Installcore1 = \"ArgvParser::\" ascii wide\n\t\t$Installcore2 = \"browser.startup.homepage\" ascii wide\n\t\t$Installcore3 = \"ADVobfuscator\" ascii wide\n\t\t$Installcore4 = \"Print out the default browser\" ascii wide\n\t\t$Installcore6 = \"__ARCLite\" ascii wide\n\t\t$Installcore7 = \"MyDeepCopy\" ascii wide\n\t\t$Installcore8 = \"deepMutableCopy\" ascii wide\n\t\t$Installcore9 = \"ChangeDefaultSearch\" ascii wide\n\t\t$Installcore10 = \"GetFake\" ascii wide\n\n\n\tcondition:\n\t\t5 of ($Installcore*)\n}\n\n\nrule Uptycs_Installcore\n{\n\tmeta:\n\t\tmalware_name = \"Installcore\"\n\t\tdescription = \"Install Core is an installer which bundles legitimate applications with offers for additional third party applications that may be unwanted by the user.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Installcore0 = \"-target\" ascii wide\n\t\t$Installcore1 = \"success\" ascii wide\n\t\t$Installcore2 = \"openurl\" ascii wide\n\t\t$Installcore3 = \"copyDir\" ascii wide\n\t\t$Installcore4 = \"BIN_VER\" ascii wide\n\t\t$Installcore5 = {6F 70 65 6E 69 6E 67 20 48 89 45 B8 48 B8 62 72 6F 77 73 65 72}\n\t\t$Installcore6 = \"encryptedFileURLWithPath\" ascii wide\n\t\t$Installcore7 = \"isEncryptedFileURL\" ascii wide\n\t\t$Installcore8 = \"fileURLWithURL\" ascii wide\n\t\t$Installcore9 = \"encryptedFileURLWithURL\" ascii wide\n\t\t$Installcore10 = \"ICDownloader\" ascii wide\n\t\t$Installcore11 = \"{_CCCryptor=}\" ascii wide\n\n\tcondition:\n\t\tall of ($Installcore*)\n}\n\n\nrule Uptycs_MacInst\n{\n\tmeta:\n\t\tmalware_name = \"MacInst\"\n\t\tdescription = \"MacInst is an unwanted macOS adware using resources of an affiliate program called “macdownloadpro.com”.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$MacInst0 = \"macInstaller v\" ascii wide\n\t\t$MacInst1 = \"WAIT::DandI\" ascii wide\n\t\t$MacInst2 = \"FINISH:: %f sec\" ascii wide\n\t\t$MacInst3 = \"Yayyy, we have the interwebs!\" ascii wide\n\t\t$MacInst4 = \"Ping_Success!\" ascii wide\n\t\t$MacInst5 = \"Someone broke the internet :(\" ascii wide\n\n\tcondition:\n\t\tall of ($MacInst*)\n}\n\n\nrule Uptycs_KeRanger_V1\n{\n\tmeta:\n\t\tmalware_name = \"KeRanger\"\n\t\tdescription = \"KeRanger is a fully functional ransomware that primarily affects Mac OS X based operating systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$KeRanger0 = \"/usr/bin/find\" ascii wide\n\t\t$KeRanger1 = \"/usr/bin/diskutil\" ascii wide\n\t\t$KeRanger2 = \"secureErase\" ascii wide\n\t\t$KeRanger3 = \"{}.crypt\" ascii wide\n\t\t$KeRanger4 = \"freespace\" ascii wide\n\t\t$KeRanger5 = \"-iname\" ascii wide\n\t\t$KeRanger6 = \"-print\" ascii wide\n\t\t$KeRanger7 = \"-exec\" ascii wide\n\n\n\tcondition:\n\t\tall of ($KeRanger*)\n}\n\n\nrule Uptycs_Hydromac\n{\n\tmeta:\n\t\tmalware_name = \"Hydromac\"\n\t\tdescription = \"Hydromac is a macOS malware leaked from a Flashcards app\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Hydromac0 = \"HM_A_Init_1\" ascii wide\n\t\t$Hydromac1 = \"HM_RA_Init_1\" ascii wide\n\t\t$Hydromac2 = \"HM_A_P_Init_1\" ascii wide\n\n\n\tcondition:\n\t\tany of ($Hydromac*)\n}\n\n\nrule Uptycs_ReverseShell_macOS\n{\n\tmeta:\n\t\tmalware_name = \"ReverseShell\"\n\t\tdescription = \"Reverse shell is a shell session established on a connection that is initiated from a remote machine.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$revshell_0 = \"_sys_process_\"  ascii wide\n\t\t$revshell_1 = \"webcam_start\"  ascii wide\n\t\t$revshell_2 = \"webcam_stop\"  ascii wide\n\t\t$revshell_3 = \"audio_mic_start\"  ascii wide\n\t\t$revshell_4 = \"audio_mic_stop\"  ascii wide\n\t\t$revshell_5 = \"tcp_channel_open\"  ascii wide\n\t\t$revshell_6 = \"Lying server\"  ascii wide\n\t\t$revshell_7 = \"SIGAR_\"  ascii wide\n\n\n\tcondition:\n\t\t5 of ($revshell*)\n}\n\n\nrule Uptycs_Shlayer_rsrc_V1\n{\n\tmeta:\n\t\tmalware_name = \"Shlayer\"\n\t\tdescription = \"Shlayer is a malvertising-focused trojan mainly targeting macOS machines.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Shlayer0 = \"$BASH_SOURCE\" ascii wide\n\t\t$Shlayer1 = \"eval\" ascii wide\n\t\t$Shlayer2 = \"$(pwd -P)\" ascii wide\n\t\t$Shlayer3 = \"-base64 -d -aes-256-cbc -nosalt -pass \" ascii wide\n\t\t$Shlayer4 = \"/Resources\" ascii wide\n\t\t$Shlayer5 = \"/.Resources/\" ascii wide\n\n\tcondition:\n\t\t5 of ($Shlayer*)\n}\n\n\nrule Uptycs_InstallMiez\n{\n\tmeta:\n\t\tmalware_name = \"InstallMiez\"\n\t\tdescription = \"InstallMiez is a typical adware infection seen in macOS whose main purpose is gaining revenue for its creators by displaying several ads\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Installcore0 = \"checkPossibleFraud\" ascii wide\n\t\t$Installcore1 = \"decryptInjection:\" ascii wide\n\t\t$Installcore2 = \"injectedInfo\" ascii wide\n\t\t$Installcore3 = \"copyDir\" ascii wide\n\t\t$Installcore4 = \"VM not found %@\" ascii wide\n\t\t$Installcore5 = \"VM found %@\" ascii wide\n\t\t$Installcore6 = \"ICDownloader\" ascii wide\n\t\t$Installcore7 = \"{_CCCryptor=}\" ascii wide\n\t\t$Installcore8 = \"terminationCallback\" ascii wide\n\t\t$Installcore9 = \"downloadingFinishCallback\" ascii wide\n\t\t$Installcore10 = \"userDownloadsFolder\" ascii wide\n\t\t$Installcore11 = \"downloadingGetFileSizeCallback\" ascii wide\n\n\n\tcondition:\n\t\tall of ($Installcore*)\n}\n\n\nrule Uptycs_Bundlore_Packed\n{\n\tmeta:\n\t\tmalware_name = \"Bundlore\"\n\t\tdescription = \"Bundlore is an installer which bundles legitimate applications with offers for additional unwanted third party applications.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Bundlore0 = {70 80 00 00 05 00 00 00 D8 80}\n\t\t$Bundlore1 = {26 00 00 00 10 00 00 00 68 80 00 00 08 00 00 00 29 00 00 00 10 00 00 00 70}\n\t\t$Bundlore2 = {39 00 00 00 3C 00 00 00 42 45 61 05}\n\n\tcondition:\n\t\tall of ($Bundlore*)\n}\n\n\nrule Uptycs_Bundlore_V1\n{\n\tmeta:\n\t\tmalware_name = \"Bundlore\"\n\t\tdescription = \"Bundlore is an installer which bundles legitimate applications with offers for additional unwanted third party applications.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Bundlore0 = \"C@H;C8w\" ascii wide\n\t\t$Bundlore1 = \"url=\" ascii wide\n\t\t$Bundlore2 = \"com.apple.metadata:kMDItemWhereFroms\" ascii wide\n\t\t$Bundlore3 = \"getxattr\" ascii wide\n\t\t$Bundlore4 = \"uuid_generate_random\" ascii wide\n\t\t$Bundlore5 = \"FILEbuf\" ascii wide\n\t\t$Bundlore6 = \"0@\" ascii wide\n\t\t$Bundlore7 = \"_CCCrypt\" ascii wide\n\n\tcondition:\n\t\tall of ($Bundlore*)\n}\n\n\nrule Uptycs_Bundlore_V2\n{\n\tmeta:\n\t\tmalware_name = \"Bundlore\"\n\t\tdescription = \"Bundlore is an installer which bundles legitimate applications with offers for additional unwanted third party applications.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Bundlore0 = \"D0%\" ascii wide\n\t\t$Bundlore1 = \"D05\" ascii wide\n\t\t$Bundlore2 = \"NSAutoreleasePool\" ascii wide\n\t\t$Bundlore3 = \"waitUntilExit\" ascii wide\n\t\t$Bundlore4 = \"terminationStatus\" ascii wide\n\t\t$Bundlore5 = \"UUIDString\" ascii wide\n\t\t$Bundlore6 = \"BundleIdentifier\" ascii wide\n\t\t$Bundlore7 = \"writeToFile:atomically:\" ascii wide\n\t\t$Bundlore8 = \"BSCS\" ascii wide\n\n\n\tcondition:\n\t\tall of ($Bundlore*)\n}\n\n\nrule Uptycs_Shlayer_Tail_V1\n{\n\tmeta:\n\t\tmalware_name = \"Shlayer\"\n\t\tdescription = \"Shlayer is a malvertising-focused trojan mainly targeting macOS machines.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Shlayer0 = \"#!/bin/\" ascii wide\n\t\t$Shlayer1 = \"TMPFOLDER\" ascii wide\n\t\t$Shlayer2 = \"tail\" ascii wide\n\t\t$Shlayer5 = \"funzip\" ascii wide\n\t\t$Shlayer6 = \"chmod\" ascii wide\n\t\t$Shlayer7 = \"nohup\" ascii wide\n\t\t$Shlayer8 = \"installing...\" ascii wide\n\t\t$Shlayer9 = \"bin/tar -C\" ascii wide\n\t\t$Shlayer10 = \"PK\" ascii wide\n\t\t$Shlayer11 = \"bin/uuidgen\" ascii wide\n\t\t$Shlayer12 = \"bin/echo\" ascii wide\n\n\tcondition:\n\t\tall of ($Shlayer*)\n}\n\n\nrule Uptycs_BitcoinMiner_V1\n{\n\tmeta:\n\t\tmalware_name = \"Coinminer\"\n\t\tdescription = \"Coin miner is an application that uses the computing power to mine digital currency.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$BitcoinMiner0 = \"miner_conf.json\" ascii wide\n\t\t$BitcoinMiner1 = \"WalletGui\" ascii wide\n\t\t$BitcoinMiner2 = \"coinbase\" ascii wide\n\t\t$BitcoinMiner3 = \"miner\" ascii wide\n\n\tcondition:\n\t\tall of ($BitcoinMiner*)\n}\n\n\nrule Uptycs_Shlayer_rsrc\n{\n\tmeta:\n\t\tmalware_name = \"Shlayer\"\n\t\tdescription = \"Shlayer is a malvertising-focused trojan mainly targeting macOS machines.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Shlayer0 = \"#!/usr/bin/env zsh\" ascii wide\n\t\t$Shlayer1 = \"$(dirname\" ascii wide\n\t\t$Shlayer2 = \"${(%):-%x}\" ascii wide\n\t\t$Shlayer3 = \"';echo\" ascii wide\n\t\t$Shlayer5 = \"| base64 -D | /bin/zsh\" ascii wide\n\n\n\tcondition:\n\t\tall of ($Shlayer*)\n}\n\n\nrule Uptycs_BitcoinMiner_V2\n{\n\tmeta:\n\t\tmalware_name = \"Coinminer\"\n\t\tdescription = \"Coin miner is an application that uses the computing power to mine digital currency.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$BitcoinMiner0 = \"coin-json-rpc\" ascii wide\n\t\t$BitcoinMiner1 = \"Loading wallet...\" ascii wide\n\t\t$BitcoinMiner2 = \"coinbase\" ascii wide\n\t\t$BitcoinMiner3 = \"miner\" ascii wide\n\n\tcondition:\n\t\tall of ($BitcoinMiner*)\n}\n\n\nrule Uptycs_VSearch\n{\n\tmeta:\n\t\tmalware_name = \"VSearch\"\n\t\tdescription = \"VSearch is a family of adware that targets MacOS systems\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$VSearch0 = \"offer_view\" ascii wide\n\t\t$VSearch1 = \"askedOffer\" ascii wide\n\t\t$VSearch2 = \"shouldInstallOffer\" ascii wide\n\t\t$VSearch3 = \"OneSearch\" ascii wide\n\t\t$VSearch4 = \"Conduit\" ascii wide\n\t\t$VSearch5 = \"Installing\" ascii wide\n\t\t$VSearch6 = \"Extracting\" ascii wide\n\t\t$VSearch7 = \"%@?dp=%@&sdp=%@&clid=%@&f=%@&m=%i&id=%@\" ascii wide\n\n\tcondition:\n\t\t6 of ($VSearch*)\n}\n\n\nrule Uptycs_Shlayer_URL\n{\n\tmeta:\n\t\tmalware_name = \"Shlayer\"\n\t\tdescription = \"Shlayer is a malvertising-focused trojan mainly targeting macOS machines.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Shlayer0 = \"#!/bin/\" ascii wide\n\t\t$Shlayer1 = \"dlDomain\" ascii wide\n\t\t$Shlayer2 = \"chmod\" ascii wide\n\t\t$Shlayer3 = \"openssl base64 -d -A\" ascii wide\n\t\t$Shlayer4 = \"tar -xvzf\" ascii wide\n\t\t$Shlayer5 = \"binPath\" ascii wide\n\t\t$Shlayer6 = \"mkdir\" ascii wide\n\t\t$Shlayer7 = \"openssl enc -aes-256-cbc -a -salt -pass pass\" ascii wide\n\n\tcondition:\n\t\t7 of ($Shlayer*)\n}\n\n\nrule Uptycs_Installcore_V1\n{\n\tmeta:\n\t\tmalware_name = \"Installcore\"\n\t\tdescription = \"Install Core is an installer which bundles legitimate applications with offers for additional third party applications that may be unwanted by the user.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Installcore0 = \"MorelloMotioned\" ascii wide\n\t\t$Installcore1 = \"BrandywineHebrews\" ascii wide\n\t\t$Installcore2 = \"GenerousGrowse\" ascii wide\n\t\t$Installcore3 = \"BathrobedBeedies\" ascii wide\n\t\t$Installcore4 = \"chatlinesCitta\" ascii wide\n\t\t$Installcore5 = \"gymHerbalism\" ascii wide\n\t\t$Installcore6 = \"AdmirerAppellant\" ascii wide\n\t\t$Installcore7 = \"crewelworkDirectives\" ascii wide\n\t\t$Installcore8 = \"GambitsGazette\" ascii wide\n\t\t$Installcore9 = \"dirtilyEbbs\" ascii wide\n\t\t$Installcore10 = \"FrogFrontages\" ascii wide\n\t\t$Installcore11 = \"GalateaGalty\" ascii wide\n\n\tcondition:\n\t\t8 of ($Installcore*)\n}\n\n\nrule Uptycs_Bundlore_Packed_V1\n{\n\tmeta:\n\t\tmalware_name = \"Bundlore\"\n\t\tdescription = \"Bundlore is an installer which bundles legitimate applications with offers for additional unwanted third party applications.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Bundlore1 = {6A 00 48 89 E5 48 83 E4 F0 48 8B 7D 08 48 8D 75 10 89 FA 83 C2 01}\n\t\t$Bundlore2 = {C1 E2 03 48 01 F2 48 89 D1 EB 04 48 83 C1 08 48 83 39 00 75 F6 48 83 C1 08 E8}\n\t\t$Bundlore3 = \"_dup2\" ascii wide\n\t\t$Bundlore4 = \"_fork\" ascii wide\n\t\t$Bundlore5 = \"_execv\" ascii wide\n\t\t$Bundlore6 = \"/usr/bin/python\" ascii wide\n\t\t$Bundlore7 = {2F 75 73 72 2F 62 69 6E 48 89 03 66 C7 43 0C 68 6F C7 43 08 2F 70 79 74 C6 43}\n\n\tcondition:\n\t\t6 of ($Bundlore*)\n}\n\n\nrule Uptycs_FireSearch\n{\n\tmeta:\n\t\tmalware_name = \"FireSearch\"\n\t\tdescription = \"FireSearch is a browser hijacker that will change your browser search engine.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$FireSearch0 = \"mycoupo\" ascii wide\n\t\t$FireSearch1 = \"MM_FLAGS\" ascii wide\n\t\t$FireSearch2 = \"MM_CLICK\" ascii wide\n\t\t$FireSearch3 = \"MM_SEARCH\" ascii wide\n\t\t$FireSearch4 = \"killall\" ascii wide\n\n\tcondition:\n\t\tall of ($FireSearch*)\n}\n\n\nrule Uptycs_FireSearch_V1\n{\n\tmeta:\n\t\tmalware_name = \"FireSearch\"\n\t\tdescription = \"FireSearch is a browser hijacker that will change your browser search engine.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$FireSearch0 = \"ClickGenerator\" ascii wide\n\t\t$FireSearch1 = \"osascript -e 'quit app\" ascii wide\n\t\t$FireSearch2 = \"stopAllInstances\" ascii wide\n\t\t$FireSearch3 = \"BrandDomain\" ascii wide\n\t\t$FireSearch4 = \"BrandCode\" ascii wide\n\n\tcondition:\n\t\tall of ($FireSearch*)\n}\n\n\nrule Uptycs_Bundlore_V4\n{\n\tmeta:\n\t\tmalware_name = \"Bundlore\"\n\t\tdescription = \"Bundlore is an installer which bundles legitimate applications with offers for additional unwanted third party applications.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Bundlore0 = \"DDLogFormatter\" ascii wide\n\t\t$Bundlore1 = \"DDLogFileInfo\" ascii wide\n\t\t$Bundlore2 = \"ShExecuter\" ascii wide\n\t\t$Bundlore3 = {37 72 93 01 33 3D 4E 2F 50}\n\t\t$Bundlore4 = \"hardwareUUID\" ascii wide\n\t\t$Bundlore5 = {02 21 30 27 3F 30 25 E1 01 42 3F}\n\n\n\tcondition:\n\t\tall of ($Bundlore*)\n}\n\n\nrule Uptycs_XLoader\n{\n\tmeta:\n\t\tmalware_name = \"AdLoader\"\n\t\tdescription = \"AdLoader is an adware that generate revenue for their creators by displaying advertisements on users’ computers.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$XLoader0 = \"GetDisableRoot\" ascii wide\n\t\t$XLoader1 = \"mac/?v=%@\" ascii wide\n\t\t$XLoader2 = \"do shell script\" ascii wide\n\t\t$XLoader3 = \"disable_root\" ascii wide\n\t\t$XLoader4 = \"enable_desktop_log\" ascii wide\n\t\t$XLoader5 = \"splash_screen_url\" ascii wide\n\t\t$XLoader6 = \"default_search_provider_data\" ascii wide\n\n\tcondition:\n\t\tall of ($XLoader*)\n}\n\n\nrule Uptycs_BellaRAT\n{\n\tmeta:\n\t\tmalware_name = \"BellaRAT\"\n\t\tdescription = \"BellaRAT is a post-exploitation data mining tool and remote administration tool for macOS\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$BellaRAT0 = \"DecryptPasswdFromFile\" ascii wide\n\t\t$BellaRAT1 = \"executer/FakeKext.kext\" ascii wide\n\t\t$BellaRAT2 = \"load_kext.shUT\" ascii wide\n\t\t$BellaRAT3 = \"executer/root_shell.shUT\" ascii wide\n\t\t$BellaRAT4 = \"inject_payloads\" ascii wide\n\t\t$BellaRAT5 = \"appleIDPhish\" ascii wide\n\t\t$BellaRAT6 = \"bella\" ascii wide\n\t\t$BellaRAT7 = \"is_there_SUID_shell\" ascii wide\n\n\tcondition:\n\t\t4 of ($BellaRAT*)\n}\n\n\nrule Uptycs_Bundlore_V5\n{\n\tmeta:\n\t\tmalware_name = \"Bundlore\"\n\t\tdescription = \"Bundlore is an installer which bundles legitimate applications with offers for additional unwanted third party applications.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Bundlore0 = \"Browser settings will be changed\" ascii wide\n\t\t$Bundlore1 = \"%@&errors=getExtraSpecs-download-failed\" ascii wide\n\t\t$Bundlore2 = \"TrackingUrl\" ascii wide\n\t\t$Bundlore3 = \"SoftwareInstallScriptUrl\" ascii wide\n\t\t$Bundlore4 = \"sudo -k -S echo __tbt_true\" ascii wide\n\n\n\tcondition:\n\t\tall of ($Bundlore*)\n}\n\n\nrule Uptycs_Formbook_XLoader\n{\n\tmeta:\n\t\tmalware_name = \"Formbook\"\n\t\tdescription = \"Formbook is an information stealer malware that uses form grabbing technique to steal data from web forms.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Formbook0 = {34 25 77 27 9A 17 AF 80 ED B0 48}\n\t\t$Formbook1 = \"/012!,%3@@@H\" ascii wide\n\t\t$Formbook2 = {69 34 25 33 A3 66 76 6B 4F 90 61}\n\t\t$Formbook3 = \"A7i,%5vnWix\" ascii wide\n\n\tcondition:\n\t\tall of ($Formbook*)\n}\n\n\nrule Uptycs_BlueBlood\n{\n\tmeta:\n\t\tmalware_name = \"BlueBlood\"\n\t\tdescription = \"BlueBlood is a monitoring program that logs several activities in the victim machine\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$BlueBlood0 = \"Inject successful\" ascii wide\n\t\t$BlueBlood1 = \"Cannot inject Browser, please provide pid\" ascii wide\n\t\t$BlueBlood2 = \"LogLockKeeper\" ascii wide\n\t\t$BlueBlood3 = \"EnableKeyLog\" ascii wide\n\t\t$BlueBlood4 = \"takeScreenshot\" ascii wide\n\t\t$BlueBlood5 = \"injectBrowsers:\" ascii wide\n\t\t$BlueBlood6 = \"/Users/makara/Documents/\" ascii wide\n\t\t$BlueBlood7 = \"/usr/local/.logs/%@.log\" ascii wide\n\n\tcondition:\n\t\t3 of ($BlueBlood*)\n}\n\n\nrule Uptycs_KCNScrew\n{\n\tmeta:\n\t\tmalware_name = \"KCNScrew\"\n\t\tdescription = \"KCNScrew is a serial box package that has cracks and patches.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$KCNScrew0 = \"KCNLibrary\" ascii wide\n\t\t$KCNScrew1 = \"Could not apply patch. The original executable is unaltered.\" ascii wide\n\t\t$KCNScrew2 = \"Patching failed!\" ascii wide\n\t\t$KCNScrew3 = \"AutoCrackController\" ascii wide\n\t\t$KCNScrew4 = \"This patch has not been tested\" ascii wide\n\t\t\n\n\tcondition:\n\t\tall of ($KCNScrew*)\n}\n\n\nrule Uptycs_Shlayer_rsrc_V2\n{\n\tmeta:\n\t\tmalware_name = \"Shlayer\"\n\t\tdescription = \"Shlayer is a malvertising-focused trojan mainly targeting macOS machines.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Shlayer0 = \"#!/bin/\" ascii wide\n\t\t$Shlayer1 = \"rsrc\\\" | tail -c\" ascii wide\n\t\t$Shlayer2 = \"bzip2\" ascii wide\n\t\t$Shlayer3 = \"chmod\" ascii wide\n\t\t$Shlayer4 = \"/usr/bin/caffeinate\" ascii wide\n\n\n\tcondition:\n\t\tall of ($Shlayer*)\n}\n\n\nrule Uptycs_XLoader_Adload\n{\n\tmeta:\n\t\tmalware_name = \"AdLoader\"\n\t\tdescription = \"AdLoader is an adware that generate revenue for their creators by displaying advertisements on users’ computers.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$XLoader0 = {48 8D 5D B8 BA B8 00 00 00 48 89 DF E8}\n\t\t$XLoader1 = {FB FF 48 8B 43 08 48 2B 03 66 48 0F 6E C0 66 0F 62 05}\n\t\t$XLoader2 = {0F 57 C9 66 0F 7C C0 48 8D 7D A0 0F 29 0F F2 0F 59 05}\n\t\t$XLoader3 = \"4DateE\" ascii wide\n\t\t$XLoader4 = \"3any6holderI\" ascii wide\n\t\t$XLoader5 = \"smc100\" ascii wide\n\n\tcondition:\n\t\tall of ($XLoader*)\n}\n\n\nrule Uptycs_Bundlore_V3\n{\n\tmeta:\n\t\tmalware_name = \"Bundlore\"\n\t\tdescription = \"Bundlore is an installer which bundles legitimate applications with offers for additional unwanted third party applications.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Bundlore0 = \"shutdown:arg0:\" ascii wide\n\t\t$Bundlore1 = \"AWAVATS\" ascii wide\n\t\t$Bundlore2 = \"D436E57D-EFCB-4102-B375-9FF3318486A5\" ascii wide\n\n\n\tcondition:\n\t\tall of ($Bundlore*)\n}\n\n\nrule Uptycs_Bundlore_Golang\n{\n\tmeta:\n\t\tmalware_name = \"Bundlore\"\n\t\tdescription = \"Bundlore is an installer which bundles legitimate applications with offers for additional unwanted third party applications.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Bundlore0 = \"desi.guru\" ascii wide\n\t\t$Bundlore1 = \"runtime.fatalpanic\" ascii wide\n\t\t$Bundlore2 = \"runtime.cputicks\" ascii wide\n\t\t$Bundlore3 = \"runtime.pthread_kill\" ascii wide\n\t\t$Bundlore4 = \"runtime.injectglist\" ascii wide\n\n\tcondition:\n\t\tall of ($Bundlore*)\n}\n\n\nrule Uptycs_keylogger_macOS\n{\n\tmeta:\n\t\tmalware_name = \"Keylogger\"\n\t\tdescription = \"Keyloggers are a type of monitoring software designed to record keystrokes made by a user.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\tstrings:\n\t\t$Keylogger_macOS_0 = \"mouse down\" ascii wide\n\t\t$Keylogger_macOS_1 = \"mouse up\" ascii wide\n\t\t$Keylogger_macOS_2 = \"key down\" ascii wide\n\t\t$Keylogger_macOS_3 = \"key up\" ascii wide\n\t\t$Keylogger_macOS_4 = \"mouse dragged\" ascii wide\n\t\t$Keylogger_macOS_5 = \"keycode\" ascii wide\n\t\t$Keylogger_macOS_6 = \"CGEventGet\" ascii wide\n\t\t$Keylogger_macOS_7 = \"CGEEventTap\" ascii wide\n\t\t$Keylogger_macOS_8 = \"GetKbdType\" ascii wide\n\t\t\n\t\t\n\n\tcondition:\n\t\tall of ($Keylogger_macOS_*)\n}\n\n\nrule Uptycs_keylogger_Utility_macOS\n{\n\tmeta:\n\t\tmalware_name = \"Keylogger\"\n\t\tdescription = \"Keyloggers are a type of monitoring software designed to record keystrokes made by a user.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\t\t\n\tstrings:\n\t\t$keylog_0 = \"PRINTSCREEN\" ascii wide\n\t\t$keylog_1 = \"DELETE|BACKSPACE\" ascii wide\n\t\t$keylog_2 = \"DELETE-FORWARD\" ascii wide\n\t\t$keylog_3 = \"SCROLL-LOCK\" ascii wide\n\t\t$keylog_4 = \"CAPSLOCK\" ascii wide\n\t\t$keylog_5 = \"LCMD\" ascii wide\n\t\t$keylog_6 = \"RCMD\" ascii wide\n\t\t$keylog_7 = \"ARROW\" ascii wide\n\t\t$keylog_8 = \"ENTER\" ascii wide\n\t\t$keylog_9 = \"Keylogger\" ascii wide\n\t\t$keylog_10 = \"ESCAPE\" ascii wide\n\n\t\t\n\tcondition:\n\t\t9 of ($keylog_*)\n}\n\n\nrule Uptycs_Shlayer_rsrc_V3\n{\n\tmeta:\n\t\tmalware_name = \"Shlayer\"\n\t\tdescription = \"Shlayer is a malvertising-focused trojan mainly targeting macOS machines.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Shlayer0 = \"#!bin\" ascii wide\n\t\t$Shlayer1 = \"mkdir\" ascii wide\n\t\t$Shlayer2 = \"$(pwd -P)\" ascii wide\n\t\t$Shlayer3 = \"openssl enc -aes-256-cbc -a -salt -pass \" ascii wide\n\t\t$Shlayer4 = \"curl\" ascii wide\n\t\t$Shlayer5 = \"rm -rf\" ascii wide\n\t\t$Shlayer6 = \"/dev/nul\" ascii wide\n\t\t\n\n\tcondition:\n\t\tall of ($Shlayer*)\n}\n\n\nrule Uptycs_SkillFormat\n{\n\tmeta:\n\t\tmalware_name = \"SkillFormat\"\n\t\tdescription = \"SkillFormat is a Adload adware family that hijacks the browser redirecting to adware results\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$SkillFormat0 = \"AWAVAUATS\" ascii wide\n\t\t$SkillFormat1 = \"_info_injectorINS_12bad_any_castEE\" ascii wide\n\t\t$SkillFormat2 = \"K8H9K\" ascii wide\n\t\t$SkillFormat3 = \"NSt3__117\" ascii wide\n\t\t$SkillFormat4 = {EB 03 39 13 13 42 52 52 52 54 69 A9 02 F6 06 9F}\n\t\t$SkillFormat5 = {02 26 44 4E 72 50 48 2A}\n\n\n\tcondition:\n\t\tall of ($SkillFormat*)\n}\n\n\nrule Uptycs_ReverseShell_macOS_V1\n{\n\tmeta:\n\t\tmalware_name = \"ReverseShell\"\n\t\tdescription = \"Reverse shell is a shell session established on a connection that is initiated from a remote machine.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$revshell_0 = {90 90 90 90 90 90 90 90 90 90 90 90}\n\t\t$revshell_1 = {58 0F 05 EB 97 68 01 00 00 02 58 6A 01 5F 0F 05 90 90 90}\n\t\t$revshell_2 = {C3 29 C6 75 EA FF E3 90 90 90 90 90 90}\t\t\n\n\n\tcondition:\n\t\t2 of ($revshell*)\n}\n"
custom: false
