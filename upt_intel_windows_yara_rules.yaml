_type: yaraGroupRule
seedId: cf9fba61-213b-4274-9d1c-41b08c39b9f1
name: upt_intel_windows_yara_rules
description: Contextual detection rules
rules: "rule Uptycs_HTran\n{\n\tmeta:\n\t\tmalware_name = \"HTran\"\n\t\tdescription = \"HTran is a proxy tool used to intercept and redirect Transmission Control Protocol connections from the local host to a remote host.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$HTran0 = \"<listen|tran|slave>\" ascii wide\n\t\t$HTran1 = \"<ConnectPort>\" ascii wide\n\t\t$HTran2 = \"htran\" ascii wide\n\n\tcondition:\n\t\t2 of ($HTran*)\n}\n\n\nrule Uptycs_Gsecdump\n{\n\tmeta:\n\t\tmalware_name = \"Gsecdump\"\n\t\tdescription = \"Gsecdump is a credential dumper tool used to obtain password hashes and LSA secrets from Windows operating systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Gsecdump0 = \"gsecdump [options]\" ascii wide\n\t\t$Gsecdump1 = \"dump_\" ascii wide\n\t\t$Gsecdump2 = \"crap\" ascii wide\n\n\tcondition:\n\t\tall of ($Gsecdump*)\n}\n\n\nrule Uptycs_WebC2_Yahoo\n{\n\tmeta:\n\t\tmalware_name = \"WebC2\"\n\t\tdescription = \"WebC2 is a toolkit that allows threat actors to download and execute additional malicious software of their choice in the victim systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$WebC2_Yahoo0 = \"<yahoo ex=\" ascii wide\n\t\t$WebC2_Yahoo1 = \"></yahoo>\" ascii wide\n\t\t$WebC2_Yahoo2 = \"IPHONE8.5(\" ascii wide\n\n\tcondition:\n\t\tall of ($WebC2_Yahoo*)\n}\n\n\nrule Uptycs_WebC2_Table\n{\n\tmeta:\n\t\tmalware_name = \"WebC2\"\n\t\tdescription = \"WebC2 is a toolkit that allows threat actors to download and execute additional malicious software of their choice in the victim systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$WebC2_Table0 = \"<!---<table<\" ascii wide\n\t\t$WebC2_Table1 = \"<!---advertisement<script src=\" ascii wide\n\t\t$WebC2_Table2 = \"Fail To Execute The Command\" ascii wide\n\n\tcondition:\n\t\tall of ($WebC2_Table*)\n}\n\n\nrule Uptycs_WebC2_Rave\n{\n\tmeta:\n\t\tmalware_name = \"WebC2\"\n\t\tdescription = \"WebC2 is a toolkit that allows threat actors to download and execute additional malicious software of their choice in the victim systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$WebC2_Rave0 = \"123!@#qweQWE\" ascii wide\n\n\tcondition:\n\t\tall of ($WebC2_Rave*)\n}\n\n\nrule Uptycs_WebC2_QBP\n{\n\tmeta:\n\t\tmalware_name = \"WebC2\"\n\t\tdescription = \"WebC2 is a toolkit that allows threat actors to download and execute additional malicious software of their choice in the victim systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$WebC2_QBP0 = \"2010QBP//-->\" ascii wide\n\t\t$WebC2_QBP1 = \"<!--<2010QBP\" ascii wide\n\n\tcondition:\n\t\tall of ($WebC2_QBP*)\n}\n\n\nrule Uptycs_WebC2_Head\n{\n\tmeta:\n\t\tmalware_name = \"WebC2\"\n\t\tdescription = \"WebC2 is a toolkit that allows threat actors to download and execute additional malicious software of their choice in the victim systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$WebC2_Head0 = \"</head>\" ascii wide\n\t\t$WebC2_Head1 = \"<head>\" ascii wide\n\t\t$WebC2_Head2 = \"WinHTTP 1.0\" ascii wide\n\t\t$WebC2_Head_0 = \"connect ok\" ascii wide\n\t\t$WebC2_Head_1 = \"pipedatacontinue\" ascii wide\n\n\tcondition:\n\t\tall of ($WebC2_Head*) and any of ($WebC2_Head_*) \n}\n\n\nrule Uptycs_WebC2_GreenCat\n{\n\tmeta:\n\t\tmalware_name = \"WebC2\"\n\t\tdescription = \"WebC2 is a toolkit that allows threat actors to download and execute additional malicious software of their choice in the victim systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$WebC2_GreenCat0 = \"started,wait to terminate it.....\" ascii wide\n\t\t$WebC2_GreenCat1 = \"%*[^/]%*[/]%*[^/]%s\" ascii wide\n\t\t$WebC2_GreenCat2 = \"kill </p|/s> <pid|ServiceName>\" ascii wide\n\n\tcondition:\n\t\tall of ($WebC2_GreenCat*)\n}\n\n\nrule Uptycs_WebC2_CsonY21K\n{\n\tmeta:\n\t\tmalware_name = \"WebC2\"\n\t\tdescription = \"WebC2 is a toolkit that allows threat actors to download and execute additional malicious software of their choice in the victim systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$WebC2_CsonY21K0 = \"</head>\" ascii wide\n\t\t$WebC2_CsonY21K1 = \"<head>\" ascii wide\n\t\t$WebC2_CsonY21K2 = \"WinHTTP 1.0\" ascii wide\n\t\t$WebC2_CsonY21K3 = \"connect ok\" ascii wide\n\t\t$WebC2_CsonY21K4 = \"pipedatacontinue\" ascii wide\n\n\tcondition:\n\t\tall of ($WebC2_CsonY21K*)\n}\n\n\nrule Uptycs_WebC2_Bolid\n{\n\tmeta:\n\t\tmalware_name = \"WebC2\"\n\t\tdescription = \"WebC2 is a toolkit that allows threat actors to download and execute additional malicious software of their choice in the victim systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$WebC2_Bolid0 = \"Q3JlYXRlUHJvY2Vzc0E=\" ascii wide\n\t\t$WebC2_Bolid1 = \"download:\" ascii wide\n\n\tcondition:\n\t\tall of ($WebC2_Bolid*)\n}\n\n\nrule Uptycs_WebC2_Ausov\n{\n\tmeta:\n\t\tmalware_name = \"WebC2\"\n\t\tdescription = \"WebC2 is a toolkit that allows threat actors to download and execute additional malicious software of their choice in the victim systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$WebC2_Ausov0 = \"InternetOpenUrlA\" ascii wide\n\t\t$WebC2_Ausov1 = \"NOSTI=\" ascii wide\n\t\t$WebC2_Ausov2 = \"ntshrui.dll\" ascii wide\n\n\tcondition:\n\t\tall of ($WebC2_Ausov*)\n}\n\n\nrule Uptycs_QuarksPwDump\n{\n\tmeta:\n\t\tmalware_name = \"QuarksPwDump\"\n\t\tdescription = \"Quarks PwDump is a native Win32 tool to extract credentials from Windows operating systems.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$QuarksPwDump0 = \"QUARKS-\" ascii wide\n\t\t$QuarksPwDump1 = \"NTDS_\" ascii wide\n\t\t$QuarksPwDump2 = \"--dump-\" ascii wide\n\n\tcondition:\n\t\tall of ($QuarksPwDump*)\n}\n\n\nrule Uptycs_PoetRAT \n{\n\tmeta:\n\t\tmalware_name = \"PoetRAT\"\n\t\tdescription = \"PoetRAT is a malicious remote access trojan (RAT) that is primarily used to target Azerbaijan government including private companies of the energy sector\"\n\t\tauthor = \"Uptycs Inc Vamshi\"\n\t\tversion = \"1\"\n   \t \n\n\tstrings:\n\t\t$PoetRAT0 = \"Affine\"  ascii wide\n\t\t$PoetRAT1 = \"Abibliophobia23\"  ascii wide\n\n\tcondition:\n\t\tall of ($PoetRAT*)\n}\n\n\nrule Uptycs_ObliqueRAT \n{\n\tmeta:\n\t\tmalware_name = \"ObliqueRAT\"\n\t\tdescription = \"ObliqueRAT is a malicious remote access trojan (RAT) that is primarily used to target organizations in Southeast Asia\"\n\t\tauthor = \"Uptycs Inc Vamshi\"\n\t\tversion = \"1\"\n   \t \n\n\tstrings:\n\t\t$ObliqueRAT0 = \"\\\\ProgramData\\\\auto.txt\"  ascii wide\n\t\t$ObliqueRAT1 = \"\\\\lgb2\"  ascii wide\n\t\t$ObliqueRAT2 = \"Oblique\"  ascii wide\n\t\t$ObliqueRAT3 = \"\\\\ProgramData\\\\System\\\\Dump\"  ascii wide\n\n\tcondition:\n\t\t3 of ($ObliqueRAT*)\n}\n\n\nrule Uptycs_Mimikatz\n{\n\tmeta:\n\t\tmalware_name = \"Mimikatz\"\n\t\tdescription = \"Mimikatz is a post-exploitation tool that dumps passwords from memory and enables lateral movement within a network.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Mimikatz0 = \"mimikatz_\" ascii wide\n\t\t$Mimikatz1 = \"Switch to MINIDUMP\" ascii wide\n\t\t$Mimikatz2 = \"mimidrv\" ascii wide\n\t\t$Mimikatz3 = \"_lsadump_\" ascii wide\n\t\t$Mimikatz5 = \"privilege::debug\" ascii wide\n\t\t$Mimikatz6 = \"sekurlsa::logonpasswords\" ascii wide\n\t\t$Mimikatz7 = \"pr::dg\" ascii wide\n\t\t$Mimikatz8 = \"sl::lp\" ascii wide\n\t\t$Mimikatz9 = \"Pass-the-\" ascii wide\n\n\tcondition:\n\t\t5 of ($Mimikatz*)\n}\n\n\nrule Uptycs_Pypykatz\n{\n\tmeta:\n\t\tmalware_name = \"Mimikatz\"\n\t\tdescription = \"Mimikatz is a post-exploitation tool that dumps passwords from memory and enables lateral movement within a network.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Mimikatz0 = \"pypykatz\" ascii wide\n\t\t$Mimikatz1 = \"KatzSystemInfo\" ascii wide\n\t\t$Mimikatz2 = \"lsadecryptor\" ascii wide\n\t\t$Mimikatz3 = \"minikerberos\" ascii wide\n\t\t$Mimikatz4 = \"lsadecryptor\" ascii wide\n\n\tcondition:\n\t\tall of ($Mimikatz*)\n}\n\n\nrule Uptycs_HttpBrowser\n{\n\tmeta:\n\t\tmalware_name = \"HttpBrowser\"\n\t\tdescription = \"HttpBrowser is a malicious remote access trojan (RAT)RAT that uses DNS requests as a command and control mechanism.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$HttpBrowser0 = \"%d|%s|%04d/%02d/%02d %02d:%02d:%02d\" ascii wide\n\t\t$HttpBrowser1 = \"/upload?%d\" ascii wide\n\t\t$HttpBrowser2 = \"/loop?c=%s&l=%s&o=%s&u=%s&r=%d&t=%d\" ascii wide\n\t\t$HttpBrowser3 = \"gcomputer=%s&lanip=%s&uid=%s&os=%s&relay=%d&data=%s\" ascii wide\n\t\t$HttpBrowser4 = \"HttpBrowser/1.0\" ascii wide\n\n\tcondition:\n\t\t3 of ($HttpBrowser*)\n}\n\n\nrule Uptycs_Windows_Cred_Editor\n{\n\tmeta:\n\t\tmalware_name = \"Windows Credential Editor\"\n\t\tdescription = \"Windows Credential Editor is a tool that can be used by adversaries to dump and reuse Windows Credentials\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\tstrings:\n\t\t$windows_cred_edit_0 = \"hernan@ampliasecurity.com\"  ascii wide\n\t\t$windows_cred_edit_1 = \"Windows Credentials Editor\"  ascii wide\n\t\t$windows_cred_edit_2 = \"lsass.exe\"  ascii wide\n\n\tcondition:\n\t\tall of ($windows_cred_edit*)\n}\n\n\nrule Uptycs_Warzone_RAT \n{\n    meta:\n\t\tmalware_name = \"Warzone RAT\"\n\t\tdescription = \"Warzone RAT is a remote access trojan that can spy on the victim machine that steals credentials, logs keystrokes and monitors other activities of the victim.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n   \tstrings:\n\t\t$Warzone0 = \"warzone160\"  ascii wide\n\t\t$Warzone1 = \"[ENTER]\"  ascii wide\n\t\t$Warzone2 = \"[BKSP]\"  ascii wide\n\t\t$Warzone3 = \"[TAB]\"  ascii wide\n\t\t$Warzone4 = \"[CTRL]\"  ascii wide\n\t\t$Warzone5 = \"[ALT]\"  ascii wide\n\t\t$Warzone6 = \"[CAPS]\"  ascii wide\n\t\t$Warzone7 = \"[ESC]\"  ascii wide\n\t\t$Warzone8 = \"[INSERT]\"  ascii wide\n\n\tcondition:\n\t\tall of ($Warzone*)\n}\n\n\nrule uptycs_Revenge_RAT\n{\n\tmeta:\n\t\tmalware_name = \"Revenge RAT\"\n\t\tdescription = \"Revenge RAT is a Remote access trojan that has capabilities to monitor keystrokes, capture cameras, take screenshots and install other malware.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\t\t\n\n\tstrings:\n\t\t$upt_Revenge_RAT0 = \"Revenge-RAT\"  ascii wide\n\t\t$upt_Revenge_RAT1 = \"mscoree.dll\"  ascii wide\n\t\t$upt_Revenge_RAT2 = \"REVEGERRRRR.exe\"  ascii wide\n\t\t$upt_Revenge_RAT3 = \"keepAlivePing!\"  ascii wide\n\t\t$upt_Revenge_RAT4 = \"AntiVirusProduct\"  ascii wide\n\t\t$upt_Revenge_RAT5 = \"FirewallProduct\"  ascii wide\n\n\tcondition:\n\t\tall of ($upt_Revenge_RAT*)\n}\n\n\nrule Uptycs_Quasar_RAT \n{\n\tmeta:\n\t\tmalware_name = \"Quasar RAT\"\n\t\tdescription = \"QuasarRAT is a open source windows Remote Administration tool written in C#\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\tstrings:\n\t\t$Quasar_0 = \"mimikatz\"  ascii wide\n\t\t$Quasar_1 = \"NTPASSWORD\"  ascii wide\n\t\t$Quasar_2 = \"LMPASSWORD\"  ascii wide\n\t\t$Quasar_3 = \"Quasar.Common.\"  ascii wide\n\n\tcondition:\n\t\tall of ($Quasar*)\n}\n\n\nrule Uptycs_Plugx_RAT \n{\n\tmeta:\n\t\tmalware_name = \"PlugX RAT\"\n\t\tdescription = \"PlugX is a modular RAT that is known to misuse legitimate executables by using DLL side loading technique.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\tstrings:\n\t\t$Plugx_0 = \"/update?id=%8.8x\"  ascii wide\n\t\t$Plugx_1 = \"\\\\bug.log\"  ascii wide\n\t\t$Plugx_2 = \"PlugProc\"  ascii wide\n\t\t$Plugx_3 = \"%s\\\\%d.plg\"  ascii wide\n\n\tcondition:\n\t\tall of ($Plugx*)\n}\n\n\nrule Uptycs_Formbook \n{\n\tmeta:\n\t\tmalware_name = \"Formbook\"\n\t\tdescription = \"Formbook is an information stealer malware that uses form grabbing technique to steal data from web forms.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\tstrings:\n\t\t$formbook_0 = {68 7B FB 95 CB 6A 00} \n\t\t$formbook_1 = {68 BA B9 5E 5F 6A 00}\n\t\t$formbook_2 = {68 DC 70 E8 DD 6A 00}\n\n\tcondition:\n\t\tall of ($formbook*)\n}\n\n\nrule Uptycs_CobaltStrike\n{\n\tmeta:\n\t\tmalware_name = \"Cobalt Strike\"\n\t\tdescription = \"Cobalt strike is used to generate custom payloads which are used by adversaries.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\" \n\n\tstrings:\n\t\t$cobalStrikep_0 = {69 69 69 69 69 69 69 69 69 69} \n\t\t$cobalStrike_1 = {73 70 72 6E 67 00 00}\n\t\t$cobalStrike_2 = \"sha256\"\n\t\t$cobalStrike_4 = \"powershell\"\n\tcondition:\n\t\tall of ($cobalStrike*)\n}\n\n\nrule Uptycs_ChinaChopper_1 \n{\n\tmeta:\n\t\tmalware_name = \"China Chopper\"\n\t\tdescription = \"China Chopper is a webshell that can be used in compromised web servers to maintain access.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\tstrings:\n\t\t$ChinaChopper_0 = \"alexa.chinaz.com\"  ascii wide \n\t\t$ChinaChopper_1 = \"Chopper File\"  ascii wide \n\t\t$ChinaChopper_2 = \"UPDATE\"  ascii wide \n\t\t$ChinaChopper_3 = \"[CONFIG]\"  ascii wide \n\t\t$ChinaChopper_4 = \"SET [Pwd]='%s'\"  ascii wide\n\t\t$ChinaChopper_5 = \"db.mdb\"  ascii wide\n\n\tcondition:\n\t\tall of ($ChinaChopper*)\n}\n\n\nrule Uptycs_3PARA_RAT \n{\n\tmeta:\n\t\tmalware_name = \"3PARARAT\"\n\t\tdescription = \"3Para is a Remote access Trojan coded in VC++ associated with Putter Panda [APT 2] threat actor.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$3PARA_RAT_0 = \"&*SDKJfhksdf89*DIUKJDSF&*sdfsdf78sdfsdf\"  ascii wide\n\t\t$3PARA_RAT_1 = \"dpara1=%\"  ascii wide\n\t\t$3PARA_RAT_2 = \"dpara2=%d\"  ascii wide\n\t\t$3PARA_RAT_3 = \"dpara3=%d\"  ascii wide\n\t\t$3PARA_RAT_4 = \"dgroupid=%d\"  ascii wide\n\t\t$3PARA_RAT_5 = \"duserid=%d\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($3PARA_RAT*)\n}\n\n\nrule Uptycs_Cachedump \n{\n\tmeta:\n\t\tmalware_name = \"Cachedump\"\n\t\tdescription = \"Cachedump is a tool that extracts cached passwords from the windows registry which might be used by adversaries to carry out lateral movement.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$cachedump_0 = \"cachedumppipe\"  ascii wide \n\t\t$cachedump_1 = \"SECURITY\\\\CACHE\"  ascii wide \n\t\t$cachedump_2 = \"lsasrv.dll\"  ascii wide\n\t\t$cachedump_3 = \"LSASS.EXE\"  ascii wide \n\n\n\tcondition:\n\t\tall of ($cachedump*)\n}\n\n\nrule Uptycs_HTTPClient \n{\n\tmeta:\n\t\tmalware_name = \"HTTPClient\"\n\t\tdescription = \"HTTPClient is a tool used to Putter Panda [APT2] threat actor used as a backup or second stage tool.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$HTTPClient_0 = \"MicrosoftUpdate/WWRONG/KB\"  ascii wide\n\t\t$HTTPClient_1 = \"/default.asp?tmp=\"  ascii wide\n\t\t$HTTPClient_2 = \"cmd.exe\"  ascii wide\n\t\t$HTTPClient_3 = \"/MicrosoftUpdate/ShellEX/KB\"  ascii wide\n\t\t$HTTPClient_4 = \"recv worng 1\"  ascii wide\n\t\t$HTTPClient_5 = \"runshell\"  ascii wide\n\t\t$HTTPClient_6 = \"www.microsoft.com\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($HTTPClient*)\n}\n\n\nrule Uptycs_HyperBro \n{\n\tmeta:\n\t\tmalware_name = \"Hyperbro\"\n\t\tdescription = \"HyperBro is a in memory mostly attributed to Emissary Panda threat actor[APT27]\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$HyperBro_0 = \"F885120E-3789-4fd9-865E-DC9B4A6412D2\"  ascii wide\n\t\t$HyperBro_1 = \"explorer.exe\"  ascii wide\n\t\t$HyperBro_2 = \"shellcode\"  ascii wide\n\t\t$HyperBro_3 = \"config.ini\"  ascii wide\n\t\t$HyperBro_4 = \"Win8\"  ascii wide\n\t\t$HyperBro_5 = \"Win2003\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($HyperBro*)\n}\n\n\nrule Uptycs_PNGDowner \n{\n\tmeta:\n\t\tmalware_name = \"PNGDowner\"\n\t\tdescription = \"PNGDowner is a tool coded in VC++ and used as a download utility by PutterPanda Threat group [APT2]\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$PNGDowner_0 = \"downer.pdb\"  ascii wide\n\t\t$PNGDowner_1 = \"Mozilla/4.0\"  ascii wide\n\t\t$PNGDowner_2 = \"www.microsoft.com\"  ascii wide\n\t\t$PNGDowner_3 = \"files/xx11/index.asp?\"  ascii wide\n\t\t$PNGDowner_4 = \"files/xx11/success.asp?\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($PNGDowner*)\n}\n\n\nrule Uptycs_AgentTesla \n{\n\tmeta:\n\t\tmalware_name = \"AgentTesla\"\n\t\tdescription = \"AgentTesla is an infostealer code in .NET which can steal data from browsers, FTP clients etc, download managers etc.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$AgentTesla_0 = \"MyTemplate\"  ascii wide\n\t\t$AgentTesla_1 = \"14.0.0.0\"  ascii wide\n\t\t$AgentTesla_2 = \"My.Computer\"  ascii wide\n\t\t$AgentTesla_3 = \"My.Application\"  ascii wide\n\t\t$AgentTesla_4 = \"My.User\"  ascii wide\n\t\t$AgentTesla_5 = \"My.WebServices\"  ascii wide\n\t\t$AgentTesla_6 = \"theonionrouter.com\"  ascii wide\n\t\t$AgentTesla_7 = \"torbrowser\"  ascii wide\n\t\t$AgentTesla_8 = \"get_passwordIsSet\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($AgentTesla*)\n}\n\n\nrule Uptycs_Auriga \n{\n\tmeta:\n\t\tmalware_name = \"Auriga\"\n\t\tdescription = \"Auriga is a malware used by APT1 that is known to share functionality with BANGAT backdoor used by the same APT group.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Auriga_0 = \"SystemRoot\\\\System32\\\\arp.exe\"  ascii wide\n\t\t$Auriga_1 = \"server\\\\exe\\\\i386\\\\riodrv32.pdb\"  ascii wide\n\t\t$Auriga_2 = \"svchost.exe\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Auriga*)\n}\n\n\nrule Uptycs_Biscuit_v1 \n{\n\tmeta:\n\t\tmalware_name = \"Biscuit\"\n\t\tdescription = \"Biscuit is a malware associated with the APT1 group which can provide full access of the victim machine to the attacker.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Biscuit_0 = \"SvcHostDLL.exe\"  ascii wide\n\t\t$Biscuit_4 = \"(PDC)\"  ascii wide\n\t\t$Biscuit_5 = \"(SQL)\"  ascii wide\n\t\t$Biscuit_6 = \"(NOV)\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Biscuit*)\n}\n\n\nrule Uptycs_Biscuit_v2 \n{\n\tmeta:\n\t\tmalware_name = \"Biscuit\"\n\t\tdescription = \"Biscuit is a malware associated with the APT1 group which can provide full access of the victim machine to the attacker.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Biscuit_0 = \"bdkzt\"  ascii wide\n\t\t$Biscuit_4 = \"(PDC)\"  ascii wide\n\t\t$Biscuit_5 = \"(SQL)\"  ascii wide\n\t\t$Biscuit_6 = \"(NOV)\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Biscuit*)\n}\n\n\nrule Uptycs_FgDump \n{\n\tmeta:\n\t\tmalware_name = \"FgDump\"\n\t\tdescription = \"FgDump is a newer version of pwdump which is used for extracting NTLM and Lanman passwords on Windows which can be used by adversaries for lateral movement.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$FgDump_0 = \"servpw.exe\"  ascii wide\n\t\t$FgDump_1 = \"fgdump-log\"  ascii wide\n\t\t$FgDump_2 = \"fgexec.exe\"  ascii wide\n\t\t$FgDump_3 = \"cachedump.exe\"  ascii wide\n\t\t$FgDump_4 = \"pstgdump.exe\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($FgDump*)\n}\n\n\nrule Uptycs_Greencat \n{\n\tmeta:\n\t\tmalware_name = \"Greencat\"\n\t\tdescription = \"GreenCat is a backdoor attributed to APT1.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t\n\t\t$Greencat_2 = \"kill </p|/s> <pid|ServiceName>\"  ascii wide\n\t\t$Greencat_5 = \"Mozilla\"  ascii wide\n\t\t$Greencat_6 = \"whoami\"  ascii wide\n\t\t$Greencat_7 = \"Shell started,wait to terminate it.....\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Greencat*)\n}\n\n\nrule Uptycs_Netwire \n{\n\tmeta:\n\t\tmalware_name = \"Netwire\"\n\t\tdescription = \"Netwire is a publicly available multi-platform RAT mostly targeting Middle East Regions and has capability to log keystroke and steal credentials.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Netwire_0 = \"HostId\"  ascii wide\n\t\t$Netwire_1 = \"SOFTWARE\\\\NetWire\"  ascii wide\n\t\t$Netwire_2 = \"Microsoft\\\\Office\\\\15.0\"  ascii wide\n\t\t$Netwire_3 = \"CurrentVersion\\\\Explorer\\\\Shell Folders\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Netwire*)\n}\n\n\nrule Uptycs_NewCore_RAT \n{\n\tmeta:\n\t\tmalware_name = \"NewCore RAT\"\n\t\tdescription = \"NewCore RAT is a Windows Remote Access Tool typically attributed to Goblin Panda Threat Group.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$NewCore_0 = \"lpk.dll|find /i \\\"lpk.dll\\\"\"  ascii wide\n\t\t$NewCore_1 = \"\\\"%s\\\\lpk.dll\\\"\"  ascii wide\n\t\t$NewCore_2 = \"WinRAR\\\\shell\\\\open\\\\command\"  ascii wide\n\t\t$NewCore_3 = \".ZIP\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($NewCore*)\n}\n\n\nrule Uptycs_PTH_Genhash \n{\n\tmeta:\n\t\tmalware_name = \"PASSTHEHASH Genhash\"\n\t\tdescription = \"genhash tool belongs to PASSTHEHAHSH toolset\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$genhash_0 = \"genhash.exe mypassword\"  ascii wide\n\t\t$genhash_1 = \"hochoa@coresecurity.com\"  ascii wide\n\t\t$genhash_2 = \"SystemFunction006\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($genhash*)\n}\n\n\nrule Uptycs_PTH_IAM \n{\n\tmeta:\n\t\tmalware_name = \"PASSTHEHASH IAM.exe\"\n\t\tdescription = \"IAM.exe tool belongs to PASSTHEHAHSH toolset\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$PTH_IAM_0 = \"IAM.EXE\"  ascii wide\n\t\t$PTH_IAM_1 = \"iamdll.dll\"  ascii wide\n\t\t$PTH_IAM_2 = \"hochoa@coresecurity.com\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($PTH_IAM*)\n}\n\n\nrule Uptycs_PTH_Whosthere \n{\n\tmeta:\n\t\tmalware_name = \"PASSTHEHASH whosthere.exe\"\n\t\tdescription = \"Whosethere tool belongs to PASSTHEHAHSH toolset\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$PTH_Whosthere_0 = \"WHOSTHERE\"  ascii wide\n\t\t$PTH_Whosthere_1 = \"hernan@gmail.com\"  ascii wide\n\t\t$PTH_Whosthere_2 = \"LSASRV.DLL\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($PTH_Whosthere*)\n}\n\n\nrule Uptycs_PoisonIVY \n{\n\tmeta:\n\t\tmalware_name = \"PoisonIvy\"\n\t\tdescription = \"PoisonIvy is a Remote Access Trojan that was used against government organization, human rights organization and defence organizations.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$PoisonIVY_0 = \"CONNECT %s:%i HTTP/1.0\"  ascii wide\n\t\t$PoisonIVY_1 = \"SOFTWARE\\\\Classes\\\\http\\\\shell\\\\open\\\\commandV\"  ascii wide\n\t\t$PoisonIVY_2 = \"Software\\\\Microsoft\\\\Active Setup\\\\Installed Components\"  ascii wide\n\t\t$PoisonIVY_3 = \"Poison Ivy\"  ascii wide\n\t\t$PoisonIVY_4 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($PoisonIVY*)\n}\n\n\nrule Uptycs_Getmail \n{\n\tmeta:\n\t\tmalware_name = \"Getmail\"\n\t\tdescription = \"Getmal is a tool used by APT1 that can extract email messages and attachments from Outlook PST files\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$getmail_0 = \"SOFTWARE\\\\Clients\\\\Mail\\\\\"  ascii wide\n\t\t$getmail_1 = \"Microsoft Outlook\"  ascii wide\n\t\t$getmail_2 = \"SOFTWARE\\\\Clients\\\\Mail\"  ascii wide\n\t\t$getmail_3 = \"mftDeleted\"  ascii wide\n\t\t$getmail_4 = \"mftMail\"  ascii wide\n\t\t$getmail_5 = \"mftSent\"  ascii wide\n\t\t$getmail_6 = \"mftStuff\"  ascii wide\n\t\t$getmail_7 = \"mftOutbox\"  ascii wide\n\t\t$getmail_8 = \"mftInbox\"  ascii wide\n\t\t$getmail_9 = \"%s <-t targetFile> [-f pstFilename ] [-r all] [-s startDay] [-e endDay]\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($getmail*)\n}\n\n\nrule Uptycs_Goggles \n{\n\tmeta:\n\t\tmalware_name = \"Goggles\"\n\t\tdescription = \"Goggles is a downloader malware that is used to download encrypted malware used by APT1.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Goggles_0 = \"thequickbrownfxjmpsvalzydg\"  ascii wide\n\t\t$Goggles_1 = \"Mozilla/4.0\"  ascii wide\n\t\t$Goggles_2 = \"MSVCRT.dll\"  ascii wide\n\t\t$Goggles_3 = \"WININET.dll\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Goggles*)\n}\n\n\nrule Uptycs_Newsreels \n{\n\tmeta:\n\t\tmalware_name = \"Newsreels\"\n\t\tdescription = \"NewsReels is a HTTP backdoor used by APT1 group\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Newsreels_0 = \"aspnet_client/report.asp\"  ascii wide\n\t\t$Newsreels_1 = \"name=%s&Gender=%c&Random=%04d&SessionKey=%s*\"  ascii wide\n\t\t$Newsreels_2 = \"Mozilla/4.0\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Newsreels*)\n}\n\n\nrule Uptycs_Qbot \n{\n\tmeta:\n\t\tmalware_name = \"Qbot\"\n\t\tdescription = \"Qbot is also known as Qakbot and Pinkslipbot is a Credential stealing malware first seen in 2008.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\tstrings:\n\t\t$upt_qbot0 = \"stager_1.dll\"  ascii wide\n\t\t$upt_qbot1 = \"DllRegisterServer\"  ascii wide\n\t\t$upt_qbot2 = \"AntiVirusProduct\"  ascii wide\n\t\t$upt_qbot3 = \"Win32_OperatingSystem\"  ascii wide\n\t\t$upt_qbot4 = \"Win32_Processor\"  ascii wide\n\n\tcondition:\n\t\tall of ($upt_qbot*)\n}\n\n\nrule Uptycs_Remcos_RAT \n{\n\tmeta:\n\t\tmalware_name = \"Remcos RAT\"\n\t\tdescription = \"Remcos is a RAT that has capability to log keystrokes, take screenshots etc\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Remcos_RAT_0 = \"Remcos_Mutex_Inj\"  ascii wide\n\t\t$Remcos_RAT_1 = \"cookies.sqlite\"  ascii wide\n\t\t$Remcos_RAT_2 = \"key3.db\"  ascii wide\n\t\t$Remcos_RAT_3 = \"logins.json\"  ascii wide\n\t\t$Remcos_RAT_4 = \"[Print]\"  ascii wide\n\t\t$Remcos_RAT_5 = \"[End]\"  ascii wide\n\t\t$Remcos_RAT_6 = \"[Start]\"  ascii wide\n\t\t$Remcos_RAT_7 = \"[Left]\"  ascii wide\n\t\t$Remcos_RAT_8 = \"[Up]\"  ascii wide\n\t\t$Remcos_RAT_9 = \"[Right]\"  ascii wide\n\t\t$Remcos_RAT_10 = \"[Down]\"  ascii wide\n\t\t$Remcos_RAT_11 = \"[PagDw]\"  ascii wide\n\t\t$Remcos_RAT_12 = \"[BckSp]\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Remcos_RAT*)\n}\n\n\nrule Uptycs_Tabmsgsql \n{\n\tmeta:\n\t\tmalware_name = \"Tabmsgsql\"\n\t\tdescription = \"Tabsmsgsql is a backdoor used by APT1 group.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Tabmsgsql_0 = \"rusinfo.exe\"  ascii wide\n\t\t$Tabmsgsql_1 = \"PROXY_TYPE_AUTO_DETECT\"  ascii wide\n\t\t$Tabmsgsql_2 = \"CONIN$\"  ascii wide\n\t\t$Tabmsgsql_3 = \"Mozilla/4.0\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Tabmsgsql*)\n}\n\n\nrule Uptycs_Tarsip_Eclipse \n{\n\tmeta:\n\t\tmalware_name = \"Tarsip\"\n\t\tdescription = \"Tarsip is a backdoor used by APT1 Group which can communicate using encrypted HTTP headers.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$tarship_eclipse_0 = \"Eclipse_Client_B.pdb\"  ascii wide\n\t\t$tarship_eclipse_1 = \"forum.asp\"  ascii wide\n\t\t$tarship_eclipse_2 = \"NAME\"  ascii wide\n\t\t$tarship_eclipse_3 = \"ADDR\"  ascii wide\n\t\t$tarship_eclipse_4 = \"MARK\"  ascii wide\n\t\t\n\tcondition:\n\t\tall of ($tarship_eclipse*)\n}\n\n\nrule Uptycs_Tarship_Moon \n{\n\tmeta:\n\t\tmalware_name = \"Tarsip\"\n\t\tdescription = \"Tarsip is a backdoor used by APT1 Group which can communicate using encrypted HTTP headers.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Tarship_Moon_0 = \"MoonClient2.pdb\"  ascii wide\n\t\t$Tarship_Moon_1 = \"HTTP/1.1\"  ascii wide\n\t\t$Tarship_Moon_2 = \"ccmd.php\"  ascii wide\n\t\t$Tarship_Moon_3 = \"cnnd.php\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Tarship_Moon*)\n}\n\n\nrule Uptycs_UrSnif \n{\n\tmeta:\n\t\tmalware_name = \"Ursnif\"\n\t\tdescription = \"Ursnif is a banking trojan first seen around 2016 known to be distributed through spear phishing emails, malicious links and exploit kits.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Ursnif0 = \"Oierqsqfw\" ascii wide\n\t\t$Ursnif1 = \"KETNEL52.DLN\" ascii wide  //kernel32.dll\n\t\t$Ursnif2 = \"PTDLN.DLN\" ascii wide     //Ntdll.dll\n\t\t$Ursnif3 = \"wMarVieyfSgctiqn\" ascii wide //wMapViewOfSection\n\t\t$Ursnif4 = \"CrgateUectkon\" ascii wide   //CreateThread\n\n\n\tcondition:\n\t\tall of ($Ursnif*)\n}\n\n\nrule Uptycs_NetWire_Windows\n{\n\tmeta:\n\t\tmalware_name = \"NetWire\"\n\t\tdescription = \"NetWire is a multiplatform Remote Administration Tool (RAT) primarily focused on password stealing and has been exclusively used by criminal and APT groups.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\tstrings:\n\t\t$NetWire_0 = \"%.2d-%.2d-%.4d\" ascii wide\n\t\t$NetWire_1 = \"%s%.2d-%.2d-%.4d\" ascii wide\n\t\t$NetWire_2 = \"[%s] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]\" ascii wide\n\t\t$NetWire_3 = \"wcnwClass\" ascii wide\n\t\t$NetWire_4 = \"[Ctrl+%c]\" ascii wide\n\t\t$NetWire_5 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\ProductOptions\" ascii wide\n\t\t$NetWire_6 = \"%s\\\\.purple\\\\accounts.xml\" ascii wide\n\n\tcondition:\n\t\tall of ($NetWire_*)\n}\n\n\nrule Uptycs_PlugX_V2\n{\n    meta:\n\t\tmalware_name = \"PlugX\"\n\t\tdescription = \"PlugX is a modular RAT that is known to misuse legitimate executables by using DLL side loading technique\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\tstrings:\n\t\t$PlugX_0 = \"RYeAaIwfBSrtN\"  ascii wide\n\t\t$PlugX_1 = \"3vap.id\"  ascii wide\n\t\t$PlugX_2 = \"nthssf\"  ascii wide\n\t\t$PlugX_3 = \"aupdatecfg\"  ascii wide\n\tcondition:\n\t\t3 of ($PlugX*)\n}\n\n\nrule Uptycs_Adfind \n{\n\tmeta:\n\t\tmalware_name = \"Adfind\"\n\t\tdescription = \"Adfind is a free command line utility that can be used by adversaries to gather information from active directory.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Adfind_0 = \"AdFind\\\\AdFind\\\\AdFind.h\"  ascii wide\n\t\t$Adfind_1 = \"dBCSPwd\"  ascii wide\n\t\t$Adfind_2 = \"unicodePwd\"  ascii wide\n\t\t$Adfind_3 = \"ntPwdHistory\"  ascii wide\n\t\t$Adfind_4 = \"supplementalCredentials\"  ascii wide\n\t\t$Adfind_5 = \"lmPwdHistory\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Adfind*)\n}\n\n\nrule Uptycs_Dridex_2 \n{\n\tmeta:\n\t\tmalware_name = \"Dridex\"\n\t\tdescription = \"Dridex is a banking trojan which was first seen in 2014 known to be derived from Cridex.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Dridex_0 = {89 E5 83 EC 08 8B 45 08 66 8B 4D FA 66 83 F1 FF 66 89 4D FA 8A 10 C7 45 FC AD F2 CB F1 80 C2 01 0F BE C2 83 C4 08 5D C3 90 90 90 90}\n\t\t$Dridex_1 = {55 89 E5 56 83 EC 08 8B 45 08 B1 99 C6 45 F5 98 2A 4D F5 8A 10 66 8B }\n\t\t\n\tcondition:\n\t\tany of ($Dridex*)\n}\n\n\nrule Uptycs_Emotet \n{\n\tmeta:\n\t\tmalware_name = \"Emotet\"\n\t\tdescription = \"Emotet is a banking trojan first seen in 2014 which can steal credentials stored in browser and other data.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Emotet_0 = \"44556640LhK7vsoZCTJoUW4VOLYbKLxek4NpSzSTlPjz9R3w\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Emotet*)\n}\n\n\nrule Uptycs_Bloodhound\n{\n\tmeta:\n\t\tmalware_name = \"BloodHound\"\n\t\tdescription = \"Bloodhound is an open source Active Directory Reconnaissance(AD) tool that can discover relationships in an AD and find attack paths.\"\n\t\tauthor = \"Üptycs Inc\"\n\t\tversion = \"1\"\n\tstrings:\n\t\t$Bloodhound_Mitre_0 = \"ScreenCapturerWinMagnifierHost\"  ascii wide\n\t\t$Bloodhound_Mitre_1 = \"BloodHound\"  ascii wide\n\t\t$Bloodhound_Mitre_2 = \".exe\"  ascii wide\n\t\t$Bloodhound_Mitre_3 = \".cmd\"  ascii wide\n\t\t$Bloodhound_Mitre_4 = \".bat\"  ascii wide\n\tcondition:\n\t\tall of ($Bloodhound_Mitre*)\n}\n\n\nrule Uptycs_IcedID \n{\n\tmeta:\n\t\tmalware_name = \"IcedID\"\n\t\tdescription = \"IcedID, also known as BokBot, is a modular banking trojan that targets user financial information and is capable of acting as a dropper for other malware.\"\n\t\tauthor = \"Uptycs\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$IceD_id_0 = \"s>)?tS\"  ascii wide\n\t\t$IceD_id_1 = \"_gat=\"  ascii wide\n\t\t$IceD_id_2 = \"_ga=\"  ascii wide\n\t\t$IceD_id_3 = \"_u=\"  ascii wide\n\t\t$IceD_id_4 = \"__io=\"  ascii wide\n\t\t$IceD_id_5 = \"_gid=\"  ascii wide\n\t\t$IceD_id_6 = \"Cookie: __gads=\"  ascii wide\n\n\n\tcondition:\n\t\t6 of ($IceD_id*)\n}\n\n\nrule Uptycs_Azorult \n{\n\tmeta:\n\t\tmalware_name = \"Azorult\"\n\t\tdescription = \"Azorult is a password stealer first seen in 2016 that steals that steals browsing history, cookies, credentials, cryptocurrencies\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Azorult_0 = \"U29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cVW5pbnN0YWxs\"  ascii wide\n\t\t$Azorult_1 = \"RGlzcGxheU5hbWU=\"  ascii wide\n\t\t$Azorult_2 = \"U29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cVW5pbnN0YWxsXA==\"  ascii wide\n\t\t$Azorult_3 = \"RGlzcGxheVZlcnNpb24=\"  ascii wide\n\t\t$Azorult_4 = \"curbuf.dat\"  ascii wide\n\t\t$Azorult_5 = \"Bitcoin-Qt\"  ascii wide\n\t\t$Azorult_6 = \"wallet.dat\"  ascii wide\n\t\t$Azorult_7 = \"electrum.dat\"  ascii wide\n\t\t$Azorult_8 = \"wallet.dat\"  ascii wide\n\t\t$Azorult_9 = \"places.sqlite\"  ascii wide\n\t\t$Azorult_10 = \"</password>\"  ascii wide\n\t\t$Azorult_11 = \"<password>\"  ascii wide\n\t\t$Azorult_12 = \"</protocol>\"  ascii wide\n\t\t$Azorult_13 = \"<protocol>\"  ascii wide\n\t\t$Azorult_14 = \"Pidgin\"  ascii wide\n\t\t$Azorult_15 = \"</account>\"  ascii wide\n\t\t$Azorult_16 = \"<account>\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Azorult*)\n}\n\n\nrule Uptycs_Azorult_2 \n{\n\tmeta:\n\t\tmalware_name = \"Azorult\"\n\t\tdescription = \"Azorult is a password stealer first seen in 2016 that steals that steals browsing history, cookies, credentials, cryptocurrencies\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Azorult_0 = \"%appdata%\\\\2fda\"  ascii wide\n\t\t$Azorult_1 = \"uIE7_decodeU\"  ascii wide\n\t\t$Azorult_2 = \"DV8CF101-053A-4498-98VA-EAB3719A088W-VF9A8B7AD-0FA0-4899-B4RD-D8006738DQCD\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Azorult*)\n}\n\n\nrule Uptycs_Dumpert \n{\n\tmeta:\n\t\tmalware_name = \"Dumpert\"\n\t\tdescription = \"Dumpert is a tool that can be used by adversaries to dump credentials from lsass memory by using direct system calls. \"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Dumpert_0 = \"lsass.exe\"  ascii wide\n\t\t$Dumpert_1 = \"@Outflank\"  ascii wide\n\t\t$Dumpert_2 = \"Dumpert\"  ascii wide\n\t\t$Dumpert_3 = \"Cneeliz\"  ascii wide\n\t\t$Dumpert_4 = \"ZwProtectVirtualMemory\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Dumpert*)\n}\n\n\nrule Uptycs_Lazagne \n{\n\tmeta:\n\t\tmalware_name = \"Lazagne\"\n\t\tdescription = \"LaZagne is a post-exploitation tool used to recover stored passwords on a system\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Lazagne_0 = \"lazagne.exe\"  ascii wide\n\t\t$Lazagne_1 = \"sqlite3.db\"  ascii wide\n\t\t$Lazagne_2 = \"sqlite3.dump\"  ascii wide\n\t\t$Lazagne_3 = \"pypykatz\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Lazagne*)\n}\n\n\nrule Uptycs_AgentTesla_9 \n{\n\tmeta:\n\t\tmalware_name = \"Agent Tesla\"\n\t\tdescription = \"AgentTesla is an infostealer code in .NET which can steal data from browsers, FTP clients etc, download managers etc.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$AgentTesla9_0 = \"SHADOW_COPY_DIRS\"  ascii wide\n\t\t$AgentTesla9_1 = \"SELECT * FROM Win32_ProcessorName\"  ascii wide\n\t\t$AgentTesla9_2 = \"Orbitum\"  ascii wide\n\t\t$AgentTesla9_3 = \"Sputnik\"  ascii wide\n\t\t$AgentTesla9_4 = \"Opera\"  ascii wide\n\t\t$AgentTesla9_5 = \"CurrentVersion\\\\Explorer\\\\StartupApproved\\\\Run\"  ascii wide\n\t\t$AgentTesla9_6 = \"Komet\"  ascii wide\n\t\t$AgentTesla9_7 = \"Chromium\"  ascii wide\n\t\t$AgentTesla9_8 = \"torrcp=%PostURL\"  ascii wide\n\t\t$AgentTesla9_9 = \"Recovered!User Name\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($AgentTesla9*)\n}\n\n\nrule Uptycs_SnakeKeylogger \n{\n\tmeta:\n\t\tmalware_name = \"SnakeKeylogger\"\n\t\tdescription = \"Snake Keylogger is an infostealer that can steal a victim’s sensitive information, log keyboard strokes, take screenshots and extract information from the system clipboard\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$SnakeKeylogger_0 = \"COVIDST\"  ascii wide\n\t\t$SnakeKeylogger_1 = \"GetOutlookPasswords\"  ascii wide\n\t\t$SnakeKeylogger_2 = \"wifipassword_single\"  ascii wide\n\t\t$SnakeKeylogger_3 = \"SNAKE-KEYLOGGER\"  ascii wide\n\t\t$SnakeKeylogger_4 = \"get_passwords\"  ascii wide\n\t\t$SnakeKeylogger_5 = \"TheTelegramToken\"  ascii wide\n\n\tcondition:\n\t\tall of ($SnakeKeylogger*)\n}\n\n\nrule Uptycs_OskiStealer \n{\n\tmeta:\n\t\tmalware_name = \"OskiStealer\"\n\t\tdescription = \"Oski stealer is a malicious information stealer that steals personal and sensitive information from its target\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$OskiStealer_0 = \"outlook.txt\"  ascii wide\n\t\t$OskiStealer_1 = \"Microsoft\\\\Edge\\\\User Data\\\\\"  ascii wide\n\t\t$OskiStealer_2 = \"1BEF0A57BE110FD467A\"  ascii wide\n\t\t$OskiStealer_3 = \"Local State\"  ascii wide\n\n\tcondition:\n\t\tall of ($OskiStealer*)\n}\n\n\nrule Uptycs_AsyncRAT \n{\n\tmeta:\n\t\tmalware_name = \"AsyncRAT\"\n\t\tdescription = \"AsyncRAT is an open source remote access tool(RAT) that can be used to monitor and access computers remotely. \"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$AsyncRAT_0 = \"%AppData%\"  ascii wide\n\t\t$AsyncRAT_1 = \"/c schtasks /create /f /sc onlogon /rl highest /tn\"  ascii wide\n\t\t$AsyncRAT_2 = \"\\\\nuR\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\\\\erawtfoS\"  ascii wide\n\t\t$AsyncRAT_3 = \"Select * from Win32_ComputerSystem\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($AsyncRAT*)\n}\n\n\nrule Uptycs_Trickbot_3 \n{\n\tmeta:\n\t\tmalware_name = \"Trickbot\"\n\t\tdescription = \"Trickbot is a banking trojan that targets banks in the United States, Canada, UK, Germany and Australia.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Trickbot_0 = \"pwgrab64\"  ascii wide nocase\n\t\t$Trickbot_1 = \"dpost\"  ascii wide nocase\n\t\t$Trickbot_2 = \"Filezilla\"  ascii wide nocase\n\t\t$Trickbot_3 = \"sitemanager.xml\"  ascii wide nocase\n\n\n\tcondition:\n\t\tall of ($Trickbot*)\n}\n\n\nrule Uptycs_Mydoom \n{\n\tmeta:\n\t\tmalware_name = \"MyDoom\"\n\t\tdescription = \"MyDoom is a worm affecting Windows which was first seen in 2004.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Mydoom_0 = \"web&query=%s\"  ascii wide\n\t\t$Mydoom_1 = \"mail.\"  ascii wide\n\t\t$Mydoom_2 = \"smtp.\"  ascii wide\n\t\t$Mydoom_3 = \".log\"  ascii wide\n\t\t$Mydoom_4 = \"zincite\"  ascii wide\n\t\t$Mydoom_6 = \"services\"  ascii wide\n\t\t$Mydoom_7 = \"MA%sROM:<%s>\"  ascii wide\n\t\t$Mydoom_8 = \"searchhp&\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Mydoom*)\n}\n\n\nrule Uptycs_Loki\n{\n\tmeta:\n\t\tmalware_name = \"Loki\"\n\t\tdescription = \"Loki is an infostealer that was first seen in 2016 and is capable of stealing credentials, disabling notifications, data exfiltration and MITM attack.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Loki_0 = \"DlRycq1tP2vSeaogj5bEUFzQiHT9dmKCn6uf7xsOY0hpwr43VINX8JGBAkLMZW\"  ascii wide\n\t\t$Loki_1 = \"MAC=%02X%02X%02XINSTALL=%08X%08Xk\"  ascii wide\n\t\t$Loki_2 = \"SELECT encryptedUsername, encryptedPassword, formSubmitURL, hostname FROM moz_logins\"  ascii wide\n\t\t$Loki_3 = \"X!2$6*9(SKiasb+!v<.qF58_qwe~QsRTYvdeTYb\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Loki*)\n}\n\n\nrule Uptycs_FickerStealer \n{\n\tmeta:\n\t\tmalware_name = \"FickerStealer\"\n\t\tdescription = \"FickerStealer is an infostealer that can steal credentials stored in browsers, FTP clients and Cryptocurrency wallets.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$FickerStealer_0 = \"C:\\\\ProgramData\\\\kaosdma.txt\"  ascii wide\n\t\t$FickerStealer_1 = \"%appdata%\\\\.purple\\\\accounts.xmle2\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($FickerStealer*)\n}\n\n\nrule Uptycs_Hancitor \n{\n\tmeta:\n\t\tmalware_name = \"Hancitor\"\n\t\tdescription = \"Hancitor is a malware loader that can install other malwares on the victim machine.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Hancitor_0 = \"GUID=%I64u&BUILD=%s&INFO=%s&EXT=%s&IP=%s&TYPE=1&WIN=%d.%d\"  ascii wide\n\t\t$Hancitor_1 = \"explorer.exe\"  ascii wide\n\t\t$Hancitor_2 = \"Rundll32.exe\"  ascii wide\n\t\t$Hancitor_3 = \"MASSLoader.dll\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Hancitor*)\n}\n\n\nrule Uptycs_RacoonStealer \n{\n\tmeta:\n\t\tmalware_name = \"RacoonStealer\"\n\t\tdescription = \"RacoonStealer is an infostealer that can steal credentials, information in cryptocurrency wallets, credit card information.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$RacoonStealer_0 = \"abe2869f-9b47-4cd9-a358-c22904dba7f7\"  ascii wide nocase\n\t\t$RacoonStealer_1 = \"25ef3d2ceb7c85368a843a6d0ff8291d\"  ascii wide nocase\n\t\t$RacoonStealer_2 = \"\\\\Software\\\\Microsoft\\\\Internet Account Manager\\\\Accounts\"  ascii wide nocase\n\t\t$RacoonStealer_3 = \"Thunderbird\"  ascii wide nocase\n\t\t$RacoonStealer_4 = \"SeaMonkey\"  ascii wide nocase\n\t\t$RacoonStealer_5 = \"WaterFox\"  ascii wide nocase\n\t\t$RacoonStealer_6 = \"inetcomm\"  ascii wide nocase\n\n\n\tcondition:\n\t\tall of ($RacoonStealer*)\n}\n\n\nrule Uptycs_RedlineStealer \n{\n\tmeta:\n\t\tmalware_name = \"RedLineStealer\"\n\t\tdescription = \"Redline Stealer is an infostealer that is capable of stealing browser credentials, saved autofill information in browser forms, cryptocurrency wallets.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$RedlineStealer_0 = \"<Logins>\"  ascii wide\n\t\t$RedlineStealer_1 = \"<BrowserName>\"  ascii wide\n\t\t$RedlineStealer_2 = \"get_BrowserName\"  ascii wide\n\t\t$RedlineStealer_3 = \"get_BrowserProfile\"  ascii wide\n\t\t$RedlineStealer_4 = \"get_Logins\"  ascii wide\n\t\t$RedlineStealer_5 = \"get_Autofills\"  ascii wide\n\t\t$RedlineStealer_6 = \"<ScanScreen>\"  ascii wide\n\t\t$RedlineStealer_7 = \"<ScanTelegram>\"  ascii wide\n\t\t$RedlineStealer_8 = \"get_ScanWallets\"  ascii wide\n\t\t$RedlineStealer_9 = \"BitAppWallet\"  ascii wide\n\t\t$RedlineStealer_10 = \"EqualWallet\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($RedlineStealer*)\n}\n\n\nrule Uptycs_AgentTesla_10 \n{\n\tmeta:\n\t\tmalware_name = \"Agent Tesla\"\n\t\tdescription = \"AgentTesla is an infostealer code in .NET which can steal data from browsers, FTP clients etc, download managers etc.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$AgentTesla_0 = \"Microsoft\\\\Office\\\\15.0\\\\Outlook\\\\Profiles\\\\Outlook\\\\9375CFF0413111d3B88A00104B2A6676\"  ascii wide\n\t\t$AgentTesla_1 = \"TightVNC\\\\Server\"  ascii wide\n\t\t$AgentTesla_2 = \"Aerofox\\\\Foxmail\\\\V3.1\"  ascii wide\n\t\t$AgentTesla_3 = \"TightVNC\\\\Server\"  ascii wide\n\t\t$AgentTesla_4 = \"RealVNC\\\\WinVNC4\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($AgentTesla*)\n}\n\n\nrule Uptycs_FormBook_3 \n{\n\tmeta:\n\t\tmalware_name = \"Formbook\"\n\t\tdescription = \"Formbook is an information stealer malware that uses form grabbing technique to steal data from web forms\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$FormBook_3_0 = {81 38 90 90 90 48}\n\t\t$FormBook_3_1 = {81 38 90 90 90 49}\n\t\t$FormBook_3_2 = {81 38 90 90 90 4A}\n\t\t$FormBook_3_3 = {81 38 90 90 90 4B}\n\t\t$FormBook_3_4 = {81 38 90 90 90 4C}\n\n\n\tcondition:\n\t\tall of ($FormBook_3*)\n}\n\n\nrule Uptycs_Hawkeye \n{\n\tmeta:\n\t\tmalware_name = \"Hawkeye\"\n\t\tdescription = \"Hawkeye keylogger is a malware that can tap keystrokes, steal credentials from browsers email clients, and capture screenshots. \"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Hawkeye_0 = \"fixed_keychain.xml\"  ascii wide\n\t\t$Hawkeye_1 = \"A10B11C12D13E14F15ABCDEF(EndsWith)\"  ascii wide\n\t\t$Hawkeye_2 = \"Firefox\"  ascii wide\n\t\t$Hawkeye_3 = \"Postbox\"  ascii wide\n\t\t$Hawkeye_4 = \"Thunderbird\"  ascii wide\n\t\t$Hawkeye_5 = \"Flock\\\\Browser\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Hawkeye*)\n}\n\n\nrule Uptycs_Loki_2 \n{\n\tmeta:\n\t\tmalware_name = \"Loki\"\n\t\tdescription = \"Loki is an infostealer that was first seen in 2016 and is capable of stealing credentials, disabling notifications, data exfiltration and MITM attack.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Loki_0 = \"DlRycq1tP2vSeaogj5bEUFzQiHT9dmKCn6uf7xsOY0hpwr43VINX8JGBAkLMZW\"  ascii wide\n\t\t$Loki_1 = \"Superbird\"  ascii wide\n\t\t$Loki_2 = \"logins.json\"  ascii wide\n\t\t$Loki_3 = \"profiles.ini\"  ascii wide\n\t\t$Loki_4 = \"signons.sqlite\"  ascii wide\n\t\t$Loki_5 = \"signons.txt\"  ascii wide\n\t\t$Loki_6 = \"signons2.txt\"  ascii wide\n\t\t$Loki_7 = \"signons3.txt\"  ascii wide\n\t\t$Loki_8 = \"NETGATE\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Loki*)\n}\n\n\nrule Uptycs_AgentTesla_11 \n{\n\tmeta:\n\t\tmalware_name = \"Agent Tesla\"\n\t\tdescription = \"AgentTesla is an infostealer code in .NET which can steal data from browsers, FTP clients etc, download managers etc.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$AgentTesla_0 = \"Mozilla\"  ascii wide\n\t\t$AgentTesla_1 = \"Postbox\"  ascii wide\n\t\t$AgentTesla_2 = \"Thunderbird\"  ascii wide\n\t\t$AgentTesla_3 = \"SeaMonkey\"  ascii wide\n\t\t$AgentTesla_4 = \"Flock\"  ascii wide\n\t\t$AgentTesla_5 = \"BlackHawk\"  ascii wide\n\t\t$AgentTesla_6 = \"CyberFox\"  ascii wide\n\t\t$AgentTesla_7 = \"KMeleon\"  ascii wide\n\t\t$AgentTesla_8 = \"IceCat\"  ascii wide\n\t\t$AgentTesla_9 = \"PaleMoon\"  ascii wide\n\t\t$AgentTesla_10 = \"IceDragon\"  ascii wide\n\t\t$AgentTesla_11 = \"WaterFox\"  ascii wide\n\t\t$AgentTesla_12 = \"HMAC\"  ascii wide\n\t\t$AgentTesla_13 = \"salt\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($AgentTesla*)\n}\n\n\nrule Uptycs_Formbook_4 \n{\n\tmeta:\n\t\tmalware_name = \"Formbook\"\n\t\tdescription = \"Formbook is an information stealer malware that uses form grabbing technique to steal data from web forms\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Formbook_0 = \"snakequad\"  ascii wide\n\t\t$Formbook_1 = \"YourProfile\"  ascii wide\n\t\t$Formbook_2 = \"AutoLogin\"  ascii wide\n\t\t$Formbook_3 = \"SecureLife\"  ascii wide\n\t\t$Formbook_4 = \"PIN / CVV / Code\"  ascii wide\n\t\t$Formbook_5 = \"Secret Question:\"  ascii wide\n\t\t$Formbook_6 = \"Bank Account\"  ascii wide\n\t\t$Formbook_7 = \"Digital Wallet\"  ascii wide\n\t\t$Formbook_9 = \"Netflix\"  ascii wide\n\t\t$Formbook_10 = \"Pandora\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Formbook*)\n}\n\n\nrule Uptycs_Formbook_5 \n{\n\tmeta:\n\t\tmalware_name = \"Formbook\"\n\t\tdescription = \"Formbook is an information stealer malware that uses form grabbing technique to steal data from web forms\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Formbook_0 = {C7 85 F0 FA FF FF A5 63 63 C6}\n\t\t$Formbook_1 = {C7 85 F4 FA FF FF 84 7C 7C F8}\n\t\t$Formbook_2 = {C7 85 F8 FA FF FF 99 77 77 EE}\n\tcondition:\n\t\n\t\n\t\tall of ($Formbook*)\n}\n\n\nrule Uptycs_HVNC \n{\n\tmeta:\n\t\tmalware_name = \"HNVC\"\n\t\tdescription = \"HVNC stands for hidden virtual network computing (hVNC) module is a module which can be used by malwares to gain full access to the victim machine.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$HNVC_RAT_0 = \"hvnc_start_explorer\"  ascii wide\n\t\t$HNVC_RAT_1 = \"hvnc_start_chrome\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($HNVC_RAT*)\n}\n\n\nrule Uptycs_Matiex \n{\n\tmeta:\n\t\tmalware_name = \"Matiex\"\n\t\tdescription = \"Matiex is a keylogger that is capable of voice recording, log keystrokes, steal clipboard data and take screenshots.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Matiex_0 = \"Keystrokes.txt\"  ascii wide\n\t\t$Matiex_1 = \"Passwords.txt\"  ascii wide\n\t\t$Matiex_2 = \"Matiex\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Matiex*)\n}\n\n\nrule Uptycs_SnakeKeylogger_2 \n{\n\tmeta:\n\t\tmalware_name = \"SnakeKeylogger\"\n\t\tdescription = \"Snake Keylogger is an infostealer that can steal a victim’s sensitive information, log keyboard strokes, take screenshots and extract information from the system clipboard\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$SnakeKeylogger_0 = \"Snake Keylogger\"  ascii wide\n\t\t$SnakeKeylogger_1 = \"SlimBrowser\"  ascii wide\n\t\t$SnakeKeylogger_2 = \"PostBox\"  ascii wide\n\t\t$SnakeKeylogger_3 = \"Thunderbird\"  ascii wide\n\n\tcondition:\n\t\tall of ($SnakeKeylogger*)\n}\n\n\nrule Uptycs_Warzone_3 \n{\n    meta:\n\t\tmalware_name = \"Warzone RAT\"\n\t\tdescription = \"Warzone RAT is a remote access trojan that can spy on the victim machine that steals credentials, logs keystrokes and monitors other activities of the victim.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Warzone_0 = \"EE6165DC336B6B6D656AD9A1DDF6B16CA4698E69\"  ascii wide\n\t\t$Warzone_1 = \"TheFTPPSWD\"  ascii wide\n\t\t$Warzone_2 = \"TheSMTPPSWD\"  ascii wide\n\t\t$Warzone_3 = \"TheTelegramID\"  ascii wide\n\t\t$Warzone_4 = \"lpdwProcessID\"  ascii wide\n\t\t$Warzone_5 = \"FileZilla\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Warzone*)\n}\n\n\nrule Uptycs_CetaRAT \n{\n\tmeta:\n\t\tmalware_name = \"CetaRAT\"\n\t\tdescription = \"CetaRAT is a Remote Access Trojan  written in C# first seen in 2019 and known to be used in the SideCopy attack.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$CetaRAT_0 = \"downloadexe\"  ascii wide\n\t\t$CetaRAT_1 = \"SecurityCenter\"  ascii wide\n\t\t$CetaRAT_2 = \"AntivirusProduct\"  ascii wide\n\t\t$CetaRAT_3 = \"pkill\"  ascii wide\n\t\t$CetaRAT_4 = \"creatdir\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($CetaRAT*)\n}\n\n\nrule Uptycs_DetaRAT \n{\n\tmeta:\n\t\tmalware_name = \"DetaRAT\"\n\t\tdescription = \"DetaRAT is a Remote Access Trojan written in C# and known to be used in the SideCopy Attack against Indian government.\"\n\t\tauthor = \"Uptycs INC\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$DetaRAT_0 = \"HostsFile\"  ascii wide\n\t\t$DetaRAT_1 = \"record capture\"  ascii wide\n\t\t$DetaRAT_2 = \"save capture\"  ascii wide\n\t\t$DetaRAT_3 = \"rec.wav\"  ascii wide\n\t\t$DetaRAT_4 = \"AntivirusProduct\"  ascii wide\n\t\t$DetaRAT_5 = \"SecurityCenter2\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($DetaRAT*)\n}\n\n\nrule Uptycs_Epicenter \n{\n\tmeta:\n\t\tmalware_name = \"EpicenterRAT\"\n\t\tdescription = \"EpicenterRAT is a Remote Access Trojan first seen around 2016 and known to be used in the SideCopy attack.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Epicenter_0 = \"Epicenter_Client\"  ascii wide\n\t\t$Epicenter_1 = \"Ninja.exe\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Epicenter*)\n}\n\n\nrule Uptycs_MargulasRAT \n{\n\tmeta:\n\t\tmalware_name = \"MargulasRAT\"\n\t\tdescription = \"MargulasRAT is a Remote Access Trojan used in the Sidecopy attack against the Indian government.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Margulas_0 = \"Margulas\"  ascii wide\n\t\t$Margulas_1 = \"choice /C Y /N /D Y /T 1 & Del\"  ascii wide\n\t\t$Margulas_2 = \"PING?\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Margulas*)\n}\n\n\nrule Uptycs_Netwire_Windows_2 \n{\n\tmeta:\n\t\tmalware_name = \"Netwire\"\n\t\tdescription = \"NetWire is a multiplatform Remote Administration Tool (RAT) primarily focused on password stealing and has been exclusively used by criminal and APT groups.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Netwire_0 = \"HostId\"  ascii wide\n\t\t$Netwire_1 = \"SOFTwarE\\\\NETwIRe\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Netwire*)\n}\n\n\nrule Uptycs_NjRAT \n{\n\tmeta:\n\t\tmalware_name = \"NjRAT\"\n\t\tdescription = \"NjRat also known as bladabindi is a remote access trojan that is capable of logging keystrokes, stealing credentials stored in browsers, accessing webcam, and creating a reverse shell.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$njRAT_0 = \"D:\\\\RATS\\\\njRAT\"  ascii wide\n\t\t$njRAT_1 = \"Stub-CSharp\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($njRAT*)\n}\n\n\nrule Uptycs_ReverseRAT \n{\n\tmeta:\n\t\tmalware_name = \"ReverseRAT\"\n\t\tdescription = \"ReverseRAT is a Remote Access Trojan  capable of creating a Reverse Shell, known to be used in the SideCopy attack against India.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$ReverseRAT_0 = \"ReverseRat\"  ascii wide\n\t\t$ReverseRAT_1 = \"svchostt.exe\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($ReverseRAT*)\n}\n\n\nrule Uptycs_Xeytan \n{\n\tmeta:\n\t\tmalware_name = \"Xeytan\"\n\t\tdescription = \"Xeytan is a keylogger first seen in 2019 and is known to be used in the Sidecopy attack against India.\t\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Xeytan_0 = \"XeytanKeylogger\"  ascii wide\n\t\t$Xeytan_1 = \"e6bc1e0f-0b64-4986-bbd6-ba61cc533e0a\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Xeytan*)\n}\n\n\nrule Uptycs_AgentTesla_12 \n{\n\tmeta:\n\t\tmalware_name = \"AgentTesla\"\n\t\tdescription = \"AgentTesla is an infostealer code in .NET which can steal data from browsers, FTP clients etc, download managers etc.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$AgentTesla_0 = \"!%--314?7B9P=\"  ascii wide\n\t\t$AgentTesla_1 = \"|_MUIECUgjtu}zjvssyvua\"  ascii wide\n\t\t$AgentTesla_2 = \"get_ComputerName\"  ascii wide\n\t\t$AgentTesla_3 = \"get_PasswordHash\"  ascii wide\n\t\t$AgentTesla_4 = \"get_Browser\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($AgentTesla*)\n}\n\n\nrule Uptycs_AsyncRAT_3 \n{\n\tmeta:\n\t\tmalware_name = \"AsyncRAT\"\n\t\tdescription = \"AsyncRAT is an open source remote access tool(RAT) that can be used to monitor and access computers remotely. \"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$AsyncRAT_0 = \"87639126EA77B358F26532367DBA67C5310EF50A8D9888ED070CD40E1F605A8F\"  ascii wide\n\t\t$AsyncRAT_1 = \"vmware\"  ascii wide\n\t\t$AsyncRAT_2 = \"VirtualBox\"  ascii wide\n\t\t$AsyncRAT_3 = \"SbieDll.dll\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($AsyncRAT*)\n}\n\n\nrule Uptycs_Remcos_RAT_2 \n{\n\tmeta:\n\t\tmalware_name = \"Remcos RAT\"\n\t\tdescription = \"Remcos is a Remote Access Tool developed for surveillance purposes by a company - Breaking Security. \"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Remcos_RAT_0 = \"MicRecords\"  ascii wide\n\t\t$Remcos_RAT_1 = \"remcos.exe\"  ascii wide\n\t\t$Remcos_RAT_2 = \"Screenshots\"  ascii wide\n\t\t$Remcos_RAT_3 = \"288E5B3E10FC7B7531DB4496FA93B3CE\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Remcos_RAT*)\n}\n\n\nrule Uptycs_Badnews \n{\n\tmeta:\n\t\tmalware_name = \"Badnews\"\n\t\tdescription = \"Badnews is a backdoor with capability to monitor keystrokes, take screenshots and steal documents. \"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Badnews_0 = \"edg499.dat\"  ascii wide\n\t\t$Badnews_1 = \"TPX499.dat\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Badnews*)\n}\n\n\nrule Uptycs_Blackshades \n{\n\tmeta:\n\t\tmalware_name = \"Blackshades\"\n\t\tdescription = \"Blackshades is a Remote Access Trojan that has Java and .net versions that can used for surveillance purposes.\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Blackshades_0 = \"Blackshades\"  ascii wide\n\t\t$Blackshades_1 = \"SecurityCenter\"  ascii wide\n\t\t$Blackshades_2 = \"AntiVirusProduct\"  ascii wide\n\t\t$Blackshades_3 = \"recentservers.xml\"  ascii wide\n\t\t$Blackshades_4 = \"STATE_CLOSED\"  ascii wide\n\t\t$Blackshades_5 = \"STATE_LISTEN\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($Blackshades*)\n}\n\n\nrule Uptycs_Rubeus\n{\n\tmeta:\n\t\tmalware_name = \"Rubeus\"\n\t\tdescription = \"Rubeus is a C# toolset for raw Kerberos interaction and abuses\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$Prerequisite0 = {4D 61 69 6E 00 6D 73 63 6F 72 65 65 2E 64 6C 6C}\n\t\t$Rubeus1 = \"658C8B7F-3664-4A95-9572-A3E5871DFC06\" ascii wide\n\t\t$Rubeus2 = \"Rubeus\" ascii wide\n        $Rubeus3 = \"Bruteforce\" ascii wide\n\n\tcondition:\n\t\t1 of ($Prerequisite*) and 2 of ($Rubeus*)\n}\n\n\nrule Uptycs_qbot_5 \n{\n\tmeta:\n\t\tmalware_name = \"Qbot\"\n\t\tdescription = \"Qbot is also known as Qakbot and Pinkslipbot is a Credential stealing malware first seen in 2008.\"\n\t\tauthor = \"Uotycs_Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$qbot_5_0 = \"facebook.com\"  ascii wide\n\t\t$qbot_5_1 = \"data=[\"  ascii wide\n\t\t$qbot_5_2 = \"app=[\"  ascii wide\n\t\t$qbot_5_3 = \"profiles.ini\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($qbot_5*)\n}\n\nrule Uptycs_SquirrelWaffle \n{\n\tmeta:\n\t\tmalware_name = \"SquirrelWaffle\"\n\t\tdescription = \"SquirrelWaffle is a downloader that downloads cobalt strike Qbot\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$SquirrelWaffle_0 = \"RfKFHjkkfjOCIoWfesiaXMmBBgMDWrtNwdtenDosNdVvrRAwkIxivKJWQw\"  ascii wide\n\t\t$SquirrelWaffle_1 = \"Dll1.pdb\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($SquirrelWaffle*)\n}\n\n\nrule Uptycs_VidarStealer \n{\n\tmeta:\n\t\tmalware_name = \"Vidar\"\n\t\tdescription = \"Vidar is an information stealer that can steal banking information, saved browser passwords and login credentials etc\"\n\t\tauthor = \"Uptycs Inc\"\n\t\tversion = \"1\"\n\n\n\tstrings:\n\t\t$VidarStealer_0 = \"Trezor\"  ascii wide\n\t\t$VidarStealer_1 = \"JohnDoe\"  ascii wide\n\t\t$VidarStealer_2 = \"KardiaChain\"  ascii wide\n\t\t$VidarStealer_3 = \"imloifkgjagghnncjkhggdhalmcnfklk\"  ascii wide\n\t\t$VidarStealer_4 = \"NeoLine\"  ascii wide\n\n\n\tcondition:\n\t\tall of ($VidarStealer*)\n}\n\n"
custom: false
